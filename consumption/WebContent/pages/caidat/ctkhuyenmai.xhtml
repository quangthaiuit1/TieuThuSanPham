<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:h="http://java.sun.com/jsf/html" template="/pages/home.xhtml">
	<ui:define name="content">
		<h3 style="margin: 0px">Chương trình khuyến mãi</h3>
		<p:separator />
	<div class="ui-md-12">
		<h:form id="menuformid">
		    <p:fieldset legend="Chương trình khuyến mãi" 
							styleClass="fieldsetclass label12 borderfsnone" toggleable="true"
							toggleSpeed="500" collapsed="false">
		       <p:tabView id="tabview1" styleClass="clearfix"  >
		       <p:tab id="tab1"  title="Danh sách chương trình khuyến mãi" >
		          <div class="col-md-12"  style="padding-left:0px !important; padding-right: 0px !important;">
	              <div class="col-md-12">
	                   <p:commandButton id="xoact"  process="@this"  action="#{promotionProgramBean.delete()}" style="padding: 3px 14px 3px 16px !important;font-size:11px !important;" styleClass="buttonaddrow"
				       update=":messages,tablesp"   icon="fa fa-trash">
				          <p:confirm icon="ui-icon-alert" />
				       </p:commandButton>
					  <p:commandButton id="idorder" icon="fa fa-search" 
					  style="padding:4px !important;" styleClass="buttonaddrow" value="Tìm kiếm" />
	                  <p:commandButton process="@this" action="#{promotionProgramBean.showDialogUpload()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Nhập CT.Khuyến mãi Excel"
				         icon="fa fa-file-excel-o" />
	                  <p:overlayPanel id="imagePanel" for="idorder" hideEffect="fade" dismissable="false"
								widgetVar="panelsearch" style="width:360px;">
						<div class="col-md-12"
											style="border: 1px solid #ccc; border-radius: 6px; margin-bottom: 5px !important;">
							    <div class="col-md-12" style="padding-top:10px !important;padding-left: 0px !important; padding-right: 0px !important;">
	                                   <div class="row">
	                                       <div class="col-md-12" style="padding-left: 0px !important; padding-right: 0px !important;">
	                                           <label>Mã chương trình</label>
	                                       </div>
	                                       <div class="col-md-12" style="padding-left: 0px !important; padding-right: 0px !important; margin-bottom:5px;" >
	                                          <p:inputText value="#{promotionProgramBean.programCode}" style="width:100%" />
	                                       </div>
	                                       <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;">
	                                           <label>Sản phẩm áp dụng khuyến mãi</label>
	                                       </div>
	                                       <div class="col-md-12" style="padding-left: 0px !important; padding-right: 0px !important; margin-bottom:5px;" >
	                                           <p:autoComplete style="width:100%;"
													value="#{promotionProgramBean.product}"
													converter="abstractConverter" minQueryLength="2" 
													completeMethod="#{promotionProgramBean.completeProduct}" var="p"
													itemLabel="#{p.product_name}" itemValue="#{p}"
													forceSelection="true" onclick="this.select();">
													<p:column style="width:50px">
													   <h:outputText value="#{p.product_code}" />
													</p:column>
													<p:column style="width:150px">
													    <h:outputText value="#{p.product_name}" />
													 </p:column>
												</p:autoComplete>
	                                       </div>
	                                       <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;">
	                                           <label>Sản phẩm khuyến mãi</label>
	                                       </div>
	                                       <div class="col-md-12" style="padding-left: 0px !important; padding-right: 0px !important; margin-bottom:5px;" >
	                                           <p:autoComplete style="width:100%;"
													value="#{promotionProgramBean.promotionProduct}"
													converter="abstractConverter" minQueryLength="2" 
													completeMethod="#{promotionProgramBean.completeProduct}" var="p"
													itemLabel="#{p.product_name}" itemValue="#{p}"
													forceSelection="true" onclick="this.select();">
													<p:column style="width:50px">
													   <h:outputText value="#{p.product_code}" />
													</p:column>
													<p:column style="width:150px">
													    <h:outputText value="#{p.product_name}" />
													 </p:column>
												</p:autoComplete>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 0px !important;padding-right: 5px !important;">
	                                           <label>Từ ngày</label>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 5px !important; padding-right:0px !important;">
	                                           <label>Đến ngày</label>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
											  <p:calendar value="#{promotionProgramBean.fromDate}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true"/>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 5px !important; padding-right: 0px !important; margin-bottom:5px;" >
											  <p:calendar value="#{promotionProgramBean.toDate}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true"/>
	                                       </div>
	                                   </div>
	                                 </div>
						  </div>
							<div class="col-md-12" style="padding-left: 0px !important;padding-right: 0px !important; margin-bottom: 5px;">
							   <div class="pull-right">
									<p:commandButton value="Tìm" process="imagePanel" 
									icon="ui-icon-search" oncomplete="PF('panelsearch').hide()"
									actionListener="#{promotionProgramBean.search()}"
									update="tablesp" />
								</div>
							</div>
					  </p:overlayPanel>
	              </div>
	              <div class="col-md-12" style="margin-top: 3px;">
	                <p:dataTable value="#{promotionProgramBean.listPromotionProgram}" lazy="true"
							paginatorPosition="bottom" styleClass="tabledetail"
							paginator="true" rowKey="#{item.id}" id="tablesp"
							scrollable="true" scrollHeight="400"  paginatorTemplate="{Exporters}"
							selection="#{promotionProgramBean.promotionProgramSelect}"
							selectionMode="single" resizableColumns="true" var="item">
						<f:facet name="{Exporters}">
							  <span class="pagecurrentdisplay">
							     <h:outputText value="(#{promotionProgramBean.navigationInfo.currentPage} of #{promotionProgramBean.navigationInfo.totalPage})" />
							  </span>
							  <ul class="pagination pagination-sm" style="margin: 0px 0px !important;">
							      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo.currentPage ==1}" styleClass="fa fa-angle-double-left font_weightcus"  update="tablesp" actionListener="#{promotionProgramBean.paginatorChange(1)}" /> </li>
							      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo.currentPage ==1}" styleClass="fa fa-angle-left font_weightcus"  update="tablesp" actionListener="#{promotionProgramBean.paginatorChange(promotionProgramBean.navigationInfo.currentPage-1)}" /> </li>
								  <c:forEach var="index" items="#{promotionProgramBean.navigationInfo.indexList}">
									  <li class="#{promotionProgramBean.navigationInfo.currentPage==index ? 'active' : ''}"><p:commandLink   update="tablesp" value="#{index}" actionListener="#{promotionProgramBean.paginatorChange(index)}" /> </li>
								  </c:forEach>
								   <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo.currentPage ==promotionProgramBean.navigationInfo.totalPage}" styleClass="fa fa-angle-right font_weightcus"  update="tablesp" actionListener="#{promotionProgramBean.paginatorChange(promotionProgramBean.navigationInfo.currentPage +1)}" /> </li>
							      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo.currentPage ==promotionProgramBean.navigationInfo.totalPage}" styleClass="fa fa-angle-double-right font_weightcus"  update="tablesp" actionListener="#{promotionProgramBean.paginatorChange(promotionProgramBean.navigationInfo.totalPage)}" /> </li>
								</ul>
								<span class="rowperpage">
						        <p:selectOneMenu 
									value="#{promotionProgramBean.pageSize}"
									converter="abstractConverter" effect="fade" var="t"
									style="width:50px;margin-left:10px !important;">
									<f:selectItems value="#{promotionProgramBean.listRowPerPage}"
										var="theme" itemLabel="#{theme}"
										itemValue="#{theme}" />
									<p:column>
										<h:outputText value="#{t}" />
									</p:column>
									<p:ajax update="tablesp"  listener="#{promotionProgramBean.paginatorChange(1)}"></p:ajax>
								</p:selectOneMenu>
						        </span>
					     </f:facet>
					     <p:ajax event="rowSelect" listener="#{promotionProgramBean.showEdit()}" update="menuformid:tabview1:tab2real" />
							<p:column headerText="Mã CT" width="80">
								<h:outputText value="#{item.program_code}" />
							</p:column>
							<p:column headerText="Ngày hiệu lực" width="150">
								 <h:outputText value="#{item.effective_date}">
									<f:convertDateTime pattern="dd/MM/yyyy"/>
								  </h:outputText>
							</p:column>
							<p:column headerText="Ngày kết thúc" width="150">
								<h:outputText value="#{item.expiry_date}">
									<f:convertDateTime pattern="dd/MM/yyyy"/>
								  </h:outputText>
							</p:column>
							<p:column headerText="Người tạo" width="120" >
								<h:outputText value="#{item.created_by}" />
							</p:column>
							<p:column headerText="Ghi chú" >
								<h:outputText value="#{item.note }" />
							</p:column>
					</p:dataTable>
	          </div>
	           </div>
		       </p:tab>
		       <p:tab id="tab2"  title="Chi tiết chương trình khuyến mãi" >
		          <h:panelGroup id="tab2real">
		          <div class="col-md-12"  style="padding-left:0px !important; padding-right: 0px !important;">
		            <h:panelGroup id="subtop">
		              <div class="col-md-12">
		                  <div class="pull-right" style="color: red;position: absolute;right: 0px; top: -38px;">
		                     <p:selectBooleanCheckbox value="#{promotionProgramBean.promotionProgramCrud.disable}" itemLabel="Không còn sử dụng">
		                         <p:ajax update="@this"  />
		                     </p:selectBooleanCheckbox>
		                  </div>
		              </div>
		              <div class="col-md-12">
		                 <div class="col-md-2" style="padding-left:0px !important; padding-right: 5px !important;">
		                     <label>Mã chương trình<span style="color:red;">*</span></label>
		                 </div>
		                 <div class="col-md-3" style="padding-left: 5px !important; padding-right: 5px !important;">
		                     <label>Ngày hiệu lực<span style="color:red;">*</span></label>
		                 </div>
		                 <div class="col-md-3" style="padding-left: 5px !important; padding-right: 5px !important;">
		                     <label>Ngày kết thúc</label>
		                 </div>
		                 <div class="col-md-4" style="padding-left: 5px !important; padding-right:0px !important;">
		                    <label>Ghi chú</label>
		                 </div>
		              </div>
		              <div class="col-md-12">
		                 <div class="col-md-2" style="padding-left:0px !important; padding-right: 5px !important;">
		                     <p:inputText value="#{promotionProgramBean.promotionProgramCrud.program_code}" />
		                 </div>
		                 <div class="col-md-3" style="padding-left: 5px !important; padding-right: 5px !important;">
		                    <p:calendar value="#{promotionProgramBean.promotionProgramCrud.effective_date}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true"/>
		                 </div>
		                 <div class="col-md-3" style="padding-left: 5px !important; padding-right: 5px !important;">
		                    <p:calendar value="#{promotionProgramBean.promotionProgramCrud.expiry_date}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true"/>
		                 </div>
		                 <div class="col-md-4" style="padding-left: 5px !important; padding-right:0px !important;">
		                   <p:inputText value="#{promotionProgramBean.promotionProgramCrud.note}" />
		                 </div>
		              </div>
		              </h:panelGroup>
		              <div class="col-md-12" style="margin-top: 10px;">
		                  <div class="row">
			                  <div class="pull-right">
			                      <p:commandButton process="@this,subtop" action="#{promotionProgramBean.saveOrUpdate()}" update="tab2real,tablesp" style="padding:4px !important;" styleClass="buttonaddrow" value="Lưu/Cập nhật"
					              icon="fa fa-floppy-o" />
			                      <p:commandButton process="@this" update="tab2real" action="#{promotionProgramBean.createdNew()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Tạo mới"
					              icon="fa fa-file-text-o" />
					               <p:commandButton process="@this" update="tab2real" action="#{promotionProgramBean.copyCTKM()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Copy CTKM"
							              icon="fa fa-files-o" />
					               <p:commandButton process="@this" update="tab2real" action="#{promotionProgramBean.copyCTKM()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Copy CTKM"
							              icon="fa fa-file-text-o" />
							         <p:commandButton  onclick="utility.clickFunction('menuformid:tabview1:exportExcel');"  style="padding:4px !important;" styleClass="buttonaddrow" value="Xuất Excel"
						              icon="fa fa-file-text-o" />
						              <p:commandButton style="display:none;" id="exportExcel" onclick="monitorDownload( showStatus , hideStatus)" action="#{promotionProgramBean.exportExcel()}" />
			                  </div>
		                  </div>
		                  <div class="row" style="margin-top: 10px;">
		                      <h:panelGroup rendered="#{promotionProgramBean.promotionProgramCrud.id==0}">
				                      <div class="pull-right">
				                        <p style="color:red;font-weight:bold;">Phiếu chưa được lưu</p>
				                      </div>
			                </h:panelGroup>
		                  </div>
		              </div>
		              
		          </div>
		          <div class="col-md-12"
						style="padding-left: 0px !important; padding-right: 0px !important;">
						<p:fieldset  legend="Chi tiết chương trình khuyến mãi" styleClass="fieldsetclass label12" collapsed="false" toggleable="true">
						   <div class="col-md-12" style="margin-top: 10px !important;">
						       <p:commandButton action="#{promotionProgramBean.deleteDetail()}" style="padding: 3px 14px 3px 16px !important;font-size:11px !important;" styleClass="buttonaddrow"
						       update="tablesp1"   icon="fa fa-trash">
						          <p:confirm icon="ui-icon-alert" />
						        </p:commandButton>
							  <p:commandButton id="idorder2" icon="fa fa-search" 
							  style="padding:4px !important;" styleClass="buttonaddrow" value="Tìm kiếm" />
						       <p:commandButton process="@this" update="editdetail" action="#{promotionProgramBean.showDialogDetail()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Thêm"
				              icon="fa fa-plus" />
						       <p:commandButton  update="editdetail" action="#{promotionProgramBean.showDialogEditDetail()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Chỉnh sửa"
				              icon="fa fa-pencil" />
				              <p:overlayPanel id="imagePanel2" for="idorder2" hideEffect="fade" dismissable="false"
								widgetVar="panelsearch2" style="width:350px;">
									<div class="col-md-12" style="border: 1px solid #ccc; border-radius: 6px; margin-bottom: 5px !important;">
									    <div class="col-md-12" style="padding-top:10px !important;padding-left: 0px !important; padding-right: 0px !important;">
			                                   <div class="row">
			                                       <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;margin-top: 5px;">
			                                            <label>Sản phẩm</label>
			                                       	</div>
			                                       <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;margin-bottom: 5px;">
			                                           <p:autoComplete style="width:100%;"
														value="#{promotionProgramBean.product2}"
														converter="abstractConverter" minQueryLength="2" 
														completeMethod="#{productBean.completeProduct}" var="p"
														itemLabel="#{p.product_name}" itemValue="#{p}"
														forceSelection="true" onclick="this.select();">
														<p:column style="width:50px">
														   <h:outputText value="#{p.product_code}" />
														</p:column>
														<p:column style="width:150px">
														    <h:outputText value="#{p.product_name}" />
														 </p:column>
														</p:autoComplete>
			                                       	</div>
			                                       <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;margin-top: 5px;">
			                                            <label>Sản phẩm khuyến mãi</label>
			                                       	</div>
			                                       <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;margin-bottom: 5px;">
			                                           <p:autoComplete style="width:100%;"
														value="#{promotionProgramBean.promotionProduct2}"
														converter="abstractConverter" minQueryLength="2" 
														completeMethod="#{productBean.completeProduct}" var="p"
														itemLabel="#{p.product_name}" itemValue="#{p}"
														forceSelection="true" onclick="this.select();">
														<p:column style="width:50px">
														   <h:outputText value="#{p.product_code}" />
														</p:column>
														<p:column style="width:150px">
														    <h:outputText value="#{p.product_name}" />
														 </p:column>
														</p:autoComplete>
			                                       	</div>
			                                   </div>
			                                 </div>
									  </div>
										<div class="col-md-12" style="padding-left: 0px !important;padding-right: 0px !important; margin-bottom: 5px;">
										   <div class="pull-right">
												<p:commandButton value="Tìm" process="imagePanel2" 
												icon="ui-icon-search" oncomplete="PF('panelsearch2').hide()"
												actionListener="#{promotionProgramBean.search2()}"
												update="tablesp1" />
											</div>
										</div>
								  </p:overlayPanel>
						   </div>
						   <div class="col-md-12" >
						       <p:dataTable value="#{promotionProgramBean.listPromotionProgramDetail}" lazy="true"
										paginatorPosition="bottom" styleClass="tabledetail"
										paginator="true" rowKey="#{item1.id}" id="tablesp1" style="width:100%;"
										scrollable="true" scrollHeight="600"  paginatorTemplate="{Exporters1}"
										selection="#{promotionProgramBean.promotionProgramDetailSelect}"
										selectionMode="single" resizableColumns="true" var="item1">
									<f:facet name="{Exporters1}">
										  <span class="pagecurrentdisplay">
										     <h:outputText value="(#{promotionProgramBean.navigationInfo2.currentPage} of #{promotionProgramBean.navigationInfo2.totalPage})" />
										  </span>
										  <ul class="pagination pagination-sm" style="margin: 0px 0px !important;">
										      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo2.currentPage ==1}" styleClass="fa fa-angle-double-left font_weightcus"  update="tablesp1" actionListener="#{promotionProgramBean.paginatorChange2(1)}" /> </li>
										      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo2.currentPage ==1}" styleClass="fa fa-angle-left font_weightcus"  update="tablesp1" actionListener="#{promotionProgramBean.paginatorChange2(promotionProgramBean.navigationInfo2.currentPage-1)}" /> </li>
											  <c:forEach var="index1" items="#{promotionProgramBean.navigationInfo2.indexList}">
												  <li class="#{promotionProgramBean.navigationInfo2.currentPage==index1 ? 'active' : ''}"><p:commandLink   update="tablesp1" value="#{index1}" actionListener="#{promotionProgramBean.paginatorChange2(index1)}" /> </li>
											  </c:forEach>
											   <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo2.currentPage ==promotionProgramBean.navigationInfo2.totalPage}" styleClass="fa fa-angle-right font_weightcus"  update="tablesp1" actionListener="#{promotionProgramBean.paginatorChange2(promotionProgramBean.navigationInfo2.currentPage +1)}" /> </li>
										      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo2.currentPage ==promotionProgramBean.navigationInfo2.totalPage}" styleClass="fa fa-angle-double-right font_weightcus"  update="tablesp1" actionListener="#{promotionProgramBean.paginatorChange2(promotionProgramBean.navigationInfo2.totalPage)}" /> </li>
											</ul>
											<span class="rowperpage">
									        <p:selectOneMenu 
												value="#{promotionProgramBean.pageSize2}"
												converter="abstractConverter" effect="fade" var="t2"
												style="width:50px;margin-left:10px !important;">
												<f:selectItems value="#{promotionProgramBean.listRowPerPage2}"
													var="theme2" itemLabel="#{theme2}"
													itemValue="#{theme2}" />
												<p:column>
													<h:outputText value="#{t2}" />
												</p:column>
												<p:ajax update="tablesp1"  listener="#{promotionProgramBean.paginatorChange2(1)}"></p:ajax>
											</p:selectOneMenu>
									        </span>
								     </f:facet>
								     <p:ajax event="rowDblselect" listener="#{promotionProgramBean.showDialogEditDetail()}" update="editdetail" />
										<p:column headerText="Mã SP" width="50">
											<h:outputText value="#{item1.product.product_code}" />
										</p:column>
										<p:column headerText="Tên sản phẩm" width="250">
											<h:outputText style="white-space: initial;" value="#{item1.product.product_name}" />
										</p:column>
										<p:column headerText="Mã SPKM" width="50">
											<h:outputText value="#{item1.promotion_product.product_code}" />
										</p:column>
										<p:column headerText="Tên sản phẩm khuyến mãi" width="250">
											<h:outputText style="white-space: initial;" value="#{item1.promotion_product.product_name}" />
										</p:column>
										<p:column headerText="Số thùng" width="50" styleClass="textright">
											 <h:outputText value="#{promotionProgramBean.formatHandler.getNumberFormat(item1.box_quatity,1000)}" />
										</p:column>
										<p:column headerText="Số ĐVSP" width="70" styleClass="textright">
											 <h:outputText value="#{promotionProgramBean.formatHandler.getNumberFormat(item1.specification,1000)}" />
										</p:column>
										<p:column headerText="Số lượng KM" width="80" styleClass="textright">
											 <h:outputText value="#{promotionProgramBean.formatHandler.getNumberFormat(item1.promotion_quantity,1000)}" />
										</p:column>
										<p:column headerText="Hình thức KM" width="80" styleClass="textcenter">
											 <h:outputText style="color: red; font-size: 16px; font-weight: bold;" value="#{promotionProgramBean.formatHandler.getNumberFormat(item1.promotion_form,10)}" />
										</p:column>
								</p:dataTable>
						   </div>
						</p:fieldset>
				  </div>
		          <div class="col-md-12" style="padding-left:0px !important; padding-right: 0px !important;">
						<p:fieldset  legend="Danh sách khách hàng đã cài đặt" styleClass="fieldsetclass label12" toggleable="true" collapsed="true">
						
						   <div class="col-md-12" style="margin-top: 10px;">
						       <p:commandButton action="#{promotionProgramBean.deleteCustomerPromotionProgramSet()}" style="padding: 3px 14px 3px 16px !important;font-size:11px !important;" styleClass="buttonaddrow"
						       update="tableset"   icon="fa fa-trash">
						          <p:confirm icon="ui-icon-alert" />
						        </p:commandButton>
							  <p:commandButton id="idorder3" icon="fa fa-search" 
							  style="padding:4px !important;" styleClass="buttonaddrow" value="Tìm kiếm" />
						       <p:commandButton process="@this" update="dlgSet" action="#{promotionProgramBean.showDialogCustomerPromotionProgramSet()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Thêm"
				              icon="fa fa-plus" />
						       <p:commandButton  update="dlgSet" action="#{promotionProgramBean.showDialogEditCustomerPromotionProgramSet()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Chỉnh sửa"
				              icon="fa fa-pencil" />
				              <p:overlayPanel id="imagePanel3" for="idorder3" hideEffect="fade" dismissable="false"
								widgetVar="panelsearch3" style="width:350px;">
									<div class="col-md-12" style="border: 1px solid #ccc; border-radius: 6px; margin-bottom: 5px !important;">
									    <div class="col-md-12" style="padding-top:10px !important;padding-left: 0px !important; padding-right: 0px !important;">
			                                   <div class="row">
			                                   <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;margin-top: 5px;">
			                                            <label>Loại khách hàng</label>
			                                       	</div>
			                                       <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;margin-bottom: 5px;">
			                                            <p:selectOneMenu value="#{promotionProgramBean.customerTypesSearchSet}"
																converter="abstractConverter" effect="fade" var="t"
																style="width:100%;" filter="true" filterMatchMode="custom"
																filterFunction="utility.customFilter">
																<f:selectItem value="#{null}" itemLabel="--select--" />
																<f:selectItems value="#{promotionProgramBean.listCustomerTypes}" var="it"
																	itemLabel="#{it.name}" itemValue="#{it}" />
																<p:column>
																	<h:outputText value="#{t != null ? t.code : '' }" />
																</p:column>
																<p:column>
																	<h:outputText value="#{t != null ? t.name : '--select--' }" />
																</p:column>
																<p:ajax listener="#{promotionProgramBean.resetSearchSet()}" update="khsset" />
															</p:selectOneMenu>
			                                       	</div>
			                                       <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;margin-top: 5px;">
			                                            <label>Khách hàng</label>
			                                       	</div>
			                                       <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;margin-bottom: 5px;">
			                                           <p:autoComplete id="khsset" style="width:100%;"
														value="#{promotionProgramBean.customerSearchSet}"
														converter="abstractConverter" minQueryLength="2"  queryDelay="1000"
														completeMethod="#{promotionProgramBean.completeCustomer()}" var="p"
														itemLabel="#{p.customer_name}" itemValue="#{p}"
														forceSelection="true" onclick="this.select();">
														<p:column style="width:50px">
														   <h:outputText value="#{p.customer_code}" />
														</p:column>
														<p:column style="width:150px">
														    <h:outputText value="#{p.customer_name}" />
														 </p:column>
														</p:autoComplete>
			                                       	</div>
			                                   </div>
			                                 </div>
									  </div>
										<div class="col-md-12" style="padding-left: 0px !important;padding-right: 0px !important; margin-bottom: 5px;">
										   <div class="pull-right">
												<p:commandButton value="Tìm" process="imagePanel3" 
												icon="ui-icon-search" oncomplete="PF('panelsearch3').hide()"
												actionListener="#{promotionProgramBean.searchCustomerSet()}"
												update="" />
											</div>
										</div>
								  </p:overlayPanel>
						   </div>
						   <div class="col-md-12">
							<p:dataTable value="#{promotionProgramBean.listCustomerPromotionProgramSet}" lazy="true"
										paginatorPosition="bottom" styleClass="tabledetail" 
										paginator="true" rowKey="#{itemSet.id}" id="tableset" style="width:100%;"
										scrollable="true" scrollHeight="400"  paginatorTemplate="{ExportersSet}"
										selection="#{promotionProgramBean.customerPromotionProgramSetSelect}"
										selectionMode="single" resizableColumns="true" var="itemSet">
									<f:facet name="{ExportersSet}">
										  <span class="pagecurrentdisplay">
										     <h:outputText value="(#{promotionProgramBean.navigationInfoSet.currentPage} of #{promotionProgramBean.navigationInfoSet.totalPage})" />
										  </span>
										  <ul class="pagination pagination-sm" style="margin: 0px 0px !important;">
										      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfoSet.currentPage ==1}" styleClass="fa fa-angle-double-left font_weightcus"  update="tableset" actionListener="#{promotionProgramBean.paginatorChangeSet(1)}" /> </li>
										      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfoSet.currentPage ==1}" styleClass="fa fa-angle-left font_weightcus"  update="tableset" actionListener="#{promotionProgramBean.paginatorChangeSet(promotionProgramBean.navigationInfoSet.currentPage-1)}" /> </li>
											  <c:forEach var="indexSet" items="#{promotionProgramBean.navigationInfoSet.indexList}">
												  <li class="#{promotionProgramBean.navigationInfoSet.currentPage==indexSet ? 'active' : ''}"><p:commandLink   update="tableset" value="#{indexSet}" actionListener="#{promotionProgramBean.paginatorChangeSet(indexSet)}" /> </li>
											  </c:forEach>
											   <li><p:commandLink disabled="#{promotionProgramBean.navigationInfoSet.currentPage ==promotionProgramBean.navigationInfoSet.totalPage}" styleClass="fa fa-angle-right font_weightcus"  update="tableset" actionListener="#{promotionProgramBean.paginatorChangeSet(promotionProgramBean.navigationInfoSet.currentPage +1)}" /> </li>
										      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfoSet.currentPage ==promotionProgramBean.navigationInfoSet.totalPage}" styleClass="fa fa-angle-double-right font_weightcus"  update="tableset" actionListener="#{promotionProgramBean.paginatorChangeSet(promotionProgramBean.navigationInfoSet.totalPage)}" /> </li>
											</ul>
											<span class="rowperpage">
									        <p:selectOneMenu 
												value="#{promotionProgramBean.pageSizeSet}"
												converter="abstractConverter" effect="fade" var="ts"
												style="width:50px;margin-left:10px !important;">
												<f:selectItems value="#{promotionProgramBean.listRowPerPageSet}"
													var="themeSet" itemLabel="#{themeSet}"
													itemValue="#{themeSet}" />
												<p:column>
													<h:outputText value="#{ts}" />
												</p:column>
												<p:ajax update="tableset"  listener="#{promotionProgramBean.paginatorChangeSet(1)}"></p:ajax>
											</p:selectOneMenu>
									        </span>
								     </f:facet>
								     <p:ajax event="rowDblselect" listener="#{promotionProgramBean.showDialogEditCustomerPromotionProgramSet()}"
									update="dlgSet" />
										<p:column headerText="Mã KH" width="40">
								           <h:outputText value="#{itemSet.customer.customer_code}" />
										</p:column>
										<p:column headerText="Khách hàng" width="190">
										     <h:outputText style="white-space: initial;" value="#{itemSet.customer.customer_name}" />
										</p:column>
										<p:column headerText="Ngày hiệu lực" width="80">
										     <h:outputText value="#{itemSet.effective_date}">
										        <f:convertDateTime pattern="dd/MM/yyyy"/>
										     </h:outputText>
										</p:column>
										<p:column headerText="Ngày kết thúc" width="80">
										     <h:outputText value="#{itemSet.expiry_date}">
										        <f:convertDateTime pattern="dd/MM/yyyy"/>
										     </h:outputText>
										</p:column>
										<p:column styleClass="textcenter" headerText="Không sử dụng" width="50">
										     <p:selectBooleanCheckbox value="#{itemSet.disable}"  />
										</p:column>
								</p:dataTable>
						   </div>
						</p:fieldset>
				  </div>
				  </h:panelGroup>
		       </p:tab>
		      </p:tabView>
		      </p:fieldset>
		      <p:fieldset legend="Cài đặt chương trình khuyến mãi cho nhiều khách hàng"
							styleClass="fieldsetclass label12 borderfsnone" toggleable="true"
							toggleSpeed="500" collapsed="true">
					<div class="col-md-12" style="margin-top: 5px; padding-left:0px !important; padding-right:0px !important;">
					     <p:commandButton action="#{promotionProgramBean.deleteCustomerPromotionProgram()}" style="padding: 3px 14px 3px 16px !important;font-size:11px !important;" styleClass="buttonaddrow"
				              update=""   icon="fa fa-trash">
				           <p:confirm icon="ui-icon-alert" />
				         </p:commandButton>
		                 <p:commandButton id="idorder5" icon="fa fa-search" style="padding:4px !important;" styleClass="buttonaddrow" value="Tìm kiếm" />
			             <p:commandButton process="@this" update="dlgckm" action="#{promotionProgramBean.showDialogSetting()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Cài đặt khách hàng"
		                   icon="fa fa-pencil" />
			             <p:commandButton process="@this" update="dlgctkhcrud" action="#{promotionProgramBean.showDialogAddSettings()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Thêm CT"
		                   icon="fa fa-plus" />
			             <p:commandButton process="@this" update="dlgctkhcrud" action="#{promotionProgramBean.showDialogEditCustomerPromotionProgram()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Chỉnh sửa"
		                   icon="fa fa-cogs" />
		                    <p:commandButton process="@this" action="#{promotionProgramBean.showDialogUploadCDKH()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Cài đặt CT.Khuyến mãi cho Khách hàng Excel"
		                   icon="fa fa-file-excel-o" />
	                      <p:overlayPanel id="imagePanel5" for="idorder5" hideEffect="fade" dismissable="false"
								widgetVar="panelsearch5" style="width:360px;">
									<div class="col-md-12" style="border: 1px solid #ccc; border-radius: 6px; margin-bottom: 5px !important;">
										    <div class="col-md-12" style="margin-top:10px !important;padding-left: 0px !important; padding-right: 0px !important;">
										        <div class="row">
										           <label>Loại khách hàng</label>
										        </div>
										    </div>
										    <div class="col-md-12" style="padding-left: 0px !important; padding-right:0px !important;">
										         <div class="row">
										            <p:selectOneMenu value="#{promotionProgramBean.customerTypesSearch}"
															converter="abstractConverter" effect="fade" var="t"
															style="width:100%;" filter="true" filterMatchMode="custom"
															filterFunction="utility.customFilter">
															<f:selectItem value="#{null}" itemLabel="--select--" />
															<f:selectItems value="#{promotionProgramBean.listCustomerTypes}" var="it"
																itemLabel="#{it.name}" itemValue="#{it}" />
															<p:column>
																<h:outputText value="#{t != null ? t.name : '--select--' }" />
															</p:column>
														</p:selectOneMenu>
										         </div>
										    </div>
										    <div class="col-md-12" style="margin-top:10px !important;padding-left: 0px !important; padding-right: 0px !important;">
										        <div class="row">
										           <label>Khách hàng</label>
										        </div>
										    </div>
										    <div class="col-md-12" style="padding-left: 0px !important; padding-right:0px !important;">
										         <div class="row">
										            <p:autoComplete style="width:100%;" 
														value="#{promotionProgramBean.customerSearch}"
														converter="abstractConverter" minQueryLength="2" 
														completeMethod="#{promotionProgramBean.completeCustomerSetting}" var="p"
														itemLabel="#{p.customer_name}" itemValue="#{p}"
														forceSelection="true" onclick="this.select();">
														<p:column style="width:50px">
														   <h:outputText value="#{p.customer_code}" />
														</p:column>
														<p:column style="width:150px">
														    <h:outputText value="#{p.customer_name}" />
														 </p:column>
													</p:autoComplete>
										         </div>
										    </div>
										    <div class="col-md-12" style="margin-top:10px !important;padding-left: 0px !important; padding-right: 0px !important;">
										        <div class="row">
										           <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important;">
										              <label>Từ ngày</label>
										           </div>
										           <div class="col-md-6" style="padding-left: 5px !important; padding-right: 0px !important;">
										               <label>Đến ngày</label>
										           </div>
										        </div>
										    </div>
										    <div class="col-md-12" style="padding-left: 0px !important; padding-right:0px !important;">
										         <div class="row">
										            <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important;">
										                  <p:calendar value="#{promotionProgramBean.fromDateSearch}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true"/>
										           </div>
										           <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important;">
										                <p:calendar value="#{promotionProgramBean.toDateSearch}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true"/>
										           </div>
										         </div>
										    </div>
										    <div class="col-md-12" style="margin-top:10px !important; padding-left: 0px !important; padding-right: 0px !important;">
										        <div class="row">
										            <label>Mã chương trình</label>
										        </div>
										    </div>
										    <div class="col-md-12" style="padding-left: 0px !important; padding-right:0px !important;margin-bottom:10px !important;">
										         <div class="row">
										             <p:inputText  value="#{promotionProgramBean.promotionProgramCodeSearch}" />
										         </div>
										    </div>
				                                      
									  </div>
										<div class="col-md-12" style="padding-left: 0px !important;padding-right: 0px !important; margin-bottom: 5px;">
										   <div class="pull-right">
												<p:commandButton value="Tìm" process="imagePanel5" 
												icon="ui-icon-search" oncomplete="PF('panelsearch5').hide()"
												actionListener="#{promotionProgramBean.searchCustomerPromotionProgram()}"
												update="menuformid:table3" />
											</div>
										</div>
								  </p:overlayPanel>
					    </div>
					    <div class="col-md-12" style="margin-top: 3px;padding-left:0px !important;padding-right:0px !important;">
				                <p:dataTable value="#{promotionProgramBean.listCustomerPromotionProgram}" lazy="true"
										paginatorPosition="bottom" styleClass="tabledetail"
										paginator="true" rowKey="#{item3.id}" id="table3"
										scrollable="true" scrollHeight="700"  paginatorTemplate="{Exporters3}"
										selection="#{promotionProgramBean.customerPromotionProgramSelect}"
										selectionMode="single" resizableColumns="true" var="item3">
									<f:facet name="{Exporters3}">
										  <span class="pagecurrentdisplay">
										     <h:outputText value="(#{promotionProgramBean.navigationInfo3.currentPage} of #{promotionProgramBean.navigationInfo3.totalPage})" />
										  </span>
										  <ul class="pagination pagination-sm" style="margin: 0px 0px !important;">
										      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo3.currentPage ==1}" styleClass="fa fa-angle-double-left font_weightcus"  update="table3" actionListener="#{promotionProgramBean.paginatorChange3(1)}" /> </li>
										      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo3.currentPage ==1}" styleClass="fa fa-angle-left font_weightcus"  update="table3" actionListener="#{promotionProgramBean.paginatorChange3(promotionProgramBean.navigationInfo3.currentPage-1)}" /> </li>
											  <c:forEach var="index" items="#{promotionProgramBean.navigationInfo3.indexList}">
												  <li class="#{promotionProgramBean.navigationInfo3.currentPage==index ? 'active' : ''}"><p:commandLink   update="table3" value="#{index}" actionListener="#{promotionProgramBean.paginatorChange3(index)}" /> </li>
											  </c:forEach>
											   <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo3.currentPage ==promotionProgramBean.navigationInfo3.totalPage}" styleClass="fa fa-angle-right font_weightcus"  update="table3" actionListener="#{promotionProgramBean.paginatorChange3(promotionProgramBean.navigationInfo3.currentPage +1)}" /> </li>
										      <li><p:commandLink disabled="#{promotionProgramBean.navigationInfo3.currentPage ==promotionProgramBean.navigationInfo3.totalPage}" styleClass="fa fa-angle-double-right font_weightcus"  update="table3" actionListener="#{promotionProgramBean.paginatorChange3(promotionProgramBean.navigationInfo3.totalPage)}" /> </li>
											</ul>
											<span class="rowperpage">
									        <p:selectOneMenu 
												value="#{promotionProgramBean.pageSize3}"
												converter="abstractConverter" effect="fade" var="t"
												style="width:50px;margin-left:10px !important;">
												<f:selectItems value="#{promotionProgramBean.listRowPerPage3}"
													var="theme" itemLabel="#{theme}"
													itemValue="#{theme}" />
												<p:column>
													<h:outputText value="#{t}" />
												</p:column>
												<p:ajax update="table3"  listener="#{promotionProgramBean.paginatorChange3(1)}"></p:ajax>
											</p:selectOneMenu>
									        </span>
								     </f:facet>
								     <p:ajax event="rowDblselect" listener="#{promotionProgramBean.showDialogEditCustomerPromotionProgram()}" update="dlgctkhcrud" />
										<p:column headerText="Mã CT" width="60">
											<h:outputText value="#{item3.promotion_program.program_code}" />
										</p:column>
										<p:column headerText="Mã KH" width="50">
											 <h:outputText value="#{item3.customer.customer_code}" />
										</p:column>
										<p:column headerText="Tên khách hàng" width="250">
											<h:outputText style="white-space: initial;" value="#{item3.customer.customer_name}" />
										</p:column>
										<p:column headerText="Từ ngày" width="60" >
											<h:outputText value="#{item3.effective_date}">
											    <f:convertDateTime pattern="dd/MM/yyyy"/>
											</h:outputText>
										</p:column>
										<p:column headerText="Đến ngày" width="60">
										    <h:outputText value="#{item3.expiry_date}">
											    <f:convertDateTime pattern="dd/MM/yyyy"/>
											</h:outputText>
										</p:column>
										<p:column headerText="Không sử dụng" width="60" style="vertical-align: middle;text-align: center;">
											<p:selectBooleanCheckbox disabled="true" value="#{item3.disable}" />
										</p:column>
								</p:dataTable>
				                </div>
			   </p:fieldset>
		 </h:form>
	</div>
	<p:dialog styleClass="dialogCus" resizable="false" width="350" style="overflow: initial;"
		closeOnEscape="true" header="Chi tiết chương trình" widgetVar="dlg1">
		<h:form id="editdetail" style="width:100%;">
			   <div class="col-md-12 boxCus">
			           <div class="row">
			              <div class="col-md-12" style="padding-left:0px !important;padding-right:5px !important;">
                              <label>Sản phẩm<span style="color:red;">*</span></label>
                          </div>
                            <div class="col-md-12" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
	                            <p:autoComplete style="width:100%;"
									value="#{promotionProgramBean.promotionProgramDetailCrud.product}"
									converter="abstractConverter" minQueryLength="2" 
									completeMethod="#{promotionProgramBean.completeProduct}" var="p"
									itemLabel="#{p.product_name}" itemValue="#{p}"
									forceSelection="true" onclick="this.select();">
										<p:column style="width:50px">
										   <h:outputText value="#{p.product_code}" />
										</p:column>
										<p:column style="width:150px">
										   <h:outputText value="#{p.product_name}" />
										 </p:column>
									</p:autoComplete>
                            </div>
			              <div class="col-md-12" style="padding-left:0px !important;padding-right:5px !important;">
                              <label>Sản phẩm khuyến mãi<span style="color:red;">*</span></label>
                          </div>
                            <div class="col-md-12" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
	                            <p:autoComplete style="width:100%;"
									value="#{promotionProgramBean.promotionProgramDetailCrud.promotion_product}"
									converter="abstractConverter" minQueryLength="2" 
									completeMethod="#{promotionProgramBean.completeProduct}" var="p"
									itemLabel="#{p.product_name}" itemValue="#{p}"
									forceSelection="true" onclick="this.select();">
										<p:column style="width:50px">
										   <h:outputText value="#{p.product_code}" />
										</p:column>
										<p:column style="width:150px">
										   <h:outputText value="#{p.product_name}" />
										 </p:column>
									</p:autoComplete>
                            </div>
                          <div class="col-md-12" style="padding-left:0px !important;padding-right:5px !important;">
                              <label>Số thùng</label>
                          </div>
                           <div class="col-md-12" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
                              <p:inputNumber  value="#{promotionProgramBean.promotionProgramDetailCrud.box_quatity}" styleClass="fix_width100"
								minValue="0" decimalPlaces="3" decimalSeparator="," thousandSeparator="." />
                          </div>
                          <div class="col-md-12" style="padding-left:0px !important;padding-right:5px !important;">
                              <label>Số ĐVSP</label>
                          </div>
                           <div class="col-md-12" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
                              <p:inputNumber  value="#{promotionProgramBean.promotionProgramDetailCrud.specification}" styleClass="fix_width100"
								minValue="0" decimalPlaces="3" decimalSeparator="," thousandSeparator="." />
                          </div>
                          <div class="col-md-12" style="padding-left:0px !important;padding-right:5px !important;">
                              <label>Số lượng KM</label>
                          </div>
                           <div class="col-md-12" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
                              <p:inputNumber  value="#{promotionProgramBean.promotionProgramDetailCrud.promotion_quantity}" styleClass="fix_width100"
								minValue="0" decimalPlaces="3" decimalSeparator="," thousandSeparator="." />
                          </div>
                          <div class="col-md-12" style="padding-left:0px !important;padding-right:5px !important;">
                              <label>Hình thức khuyến mãi</label>
                          </div>
                           <div class="col-md-12" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
                              <p:inputNumber value="#{promotionProgramBean.promotionProgramDetailCrud.promotion_form}" styleClass="fix_width100"
								minValue="0" decimalPlaces="0" decimalSeparator="," thousandSeparator="." />
                          </div>
			           </div>
				</div>
				<div class="col-md-12" style="padding:10px 0px;">
				    <p:commandButton  value="Lưu/Cập nhật" update="menuformid:tabview1:tablesp1,editdetail" actionListener="#{promotionProgramBean.saveOrUpdateDetail()}" />
				</div>
		</h:form>
	</p:dialog>
	<p:dialog styleClass="dialogCus" resizable="false" width="350" style="overflow: initial;"
		closeOnEscape="true" header="Cài đặt khách hàng" widgetVar="dlgSet">
		<h:form id="dlgSet" style="width:100%;">
			   <div class="col-md-12 boxCus">
			           <div class="row">
			              <div class="col-md-12" style="padding-left:0px !important;padding-right:5px !important;">
                              <label>Loại khách hàng</label>
                          </div>
                            <div class="col-md-12" style="padding-left: 0px !important; padding-right: 0px !important; margin-bottom:5px;" >
	                            <p:selectOneMenu value="#{promotionProgramBean.customerTypesSet}"
									converter="abstractConverter" effect="fade" var="t"
									style="width:100%;" filter="true" filterMatchMode="custom"
									filterFunction="utility.customFilter">
									<f:selectItem value="#{null}" itemLabel="--select--" />
									<f:selectItems value="#{promotionProgramBean.listCustomerTypes}" var="it"
										itemLabel="#{it.name}" itemValue="#{it}" />
									<p:column>
										<h:outputText value="#{t != null ? t.code : '' }" />
									</p:column>
									<p:column>
										<h:outputText value="#{t != null ? t.name : '--select--' }" />
									</p:column>
									<p:ajax  update="@this" />
								</p:selectOneMenu>
                            </div>
                        </div>
                        <div class="row">
			              <div class="col-md-12" style="padding-left:0px !important;padding-right:0px !important;">
                              <label>Khách hàng<span style="color:red;">*</span></label>
                          </div>
                          <div class="col-md-12" style="padding-left: 0px !important; padding-right: 0px !important; margin-bottom:5px;" >
	                            <p:autoComplete style="width:100%;"
									value="#{promotionProgramBean.customerPromotionProgramSetCrud.customer}"
									converter="abstractConverter" minQueryLength="2" queryDelay="1000"
									completeMethod="#{promotionProgramBean.completeCustomerSet}" var="p"
									itemLabel="#{p.customer_name}" itemValue="#{p}"
									forceSelection="true" onclick="this.select();">
										<p:column style="width:50px">
										   <h:outputText value="#{p.customer_code}" />
										</p:column>
										<p:column style="width:150px">
										   <h:outputText value="#{p.customer_name}" />
										 </p:column>
									</p:autoComplete>
                            </div>
                          </div>
                          <div class="row">
				              <div class="col-md-6" style="padding-left:0px !important;padding-right:5px !important;">
	                              <label>Ngày hiệu lực<span style="color:red;">*</span></label>
	                          </div>
				              <div class="col-md-6" style="padding-left:5px !important;padding-right:0px !important;">
	                              <label>Ngày kết thúc</label>
	                          </div>
			              </div>
			              <div class="row">
								<div class="col-md-6"
									style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom: 5px;">
									<p:calendar value="#{promotionProgramBean.customerPromotionProgramSetCrud.effective_date}"
										pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999"
										showButtonPanel="true" />
								</div>
								<div class="col-md-6"
									style="padding-left: 5px !important; padding-right: 0px !important; margin-bottom: 5px;">
									<p:calendar value="#{promotionProgramBean.customerPromotionProgramSetCrud.expiry_date}"
										pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999"
										showButtonPanel="true" />
								</div>
					</div>
				</div>
				<div class="col-md-12" style="padding:10px 0px;">
				    <p:commandButton process="@this,dlgSet" value="Lưu/Cập nhật" update="menuformid:tabview1:tableset,dlgSet" action="#{promotionProgramBean.saveOrUpdateCustomerSet()}" />
				</div>
		</h:form>
	</p:dialog>
	<p:dialog styleClass="dialogCus" resizable="false" width="900" style="overflow: initial;"
		closeOnEscape="true" header="Cài đặt chương trình khuyến mãi" widgetVar="dlgckm">
		<h:form id="dlgckm" style="width:100%;">
			   <div class="col-md-12 boxCus">
			           <div class="row">
			              <div class="col-md-12">
			             </div>
			              <div class="col-md-6"  style="padding-left:0px !important; padding-right:0px !important; margin-top: 5px;">
			                 <label>Loại khách hàng</label>
			              </div>
			              <div class="col-md-6" style="padding-left:0px !important; padding-right:0px !important; margin-top: 5px;">
			                  <label style="margin-left: 10%;">Chương trình khuyến mãi<span style="color:red;">*</span></label>
			             </div>
			              <div class="col-md-6" style="padding-left:0px !important;padding-right:0px !important; margin-bottom: 5px;">
			                   <p:selectOneMenu value="#{promotionProgramBean.customerTypesSetting}"
									converter="abstractConverter" effect="fade" var="t"
									style="width:90%;" filter="true" filterMatchMode="custom"
									filterFunction="utility.customFilter">
									<f:selectItem value="#{null}" itemLabel="--select--" />
									<f:selectItems value="#{promotionProgramBean.listCustomerTypes}" var="it"
										itemLabel="#{it.name}" itemValue="#{it}" />
									<p:column>
										<h:outputText value="#{t != null ? t.name : '--select--' }" />
									</p:column>
									<p:ajax event="change" update="pickList" listener="#{promotionProgramBean.innitSourceCustomer()}"/>
								</p:selectOneMenu>
			              </div>
			              <div class="col-md-6" style="padding-left:0px !important;padding-right:0px !important; margin-bottom: 5px;">
			                  <p:autoComplete style="width:90%; margin-left:10%;"
									value="#{promotionProgramBean.promotionProgramSetting}"
									converter="abstractConverter" minQueryLength="2" queryDelay="1000" 
									completeMethod="#{promotionProgramBean.completePromotionProgram}" var="p"
									itemLabel="#{p.program_code}" itemValue="#{p}"
									forceSelection="true" onclick="this.select();">
									<p:column style="width:50px">
									   <h:outputText value="#{p.program_code}" />
									</p:column>
									<p:column style="width:70px">
									   <h:outputText value="#{p.effective_date}">
										<f:convertDateTime pattern="dd/MM/yyyy"/>
									  </h:outputText>
									</p:column>
									<p:column style="width:70px">
									   <h:outputText value="#{p.expiry_date}">
										<f:convertDateTime pattern="dd/MM/yyyy"/>
									  </h:outputText>
									</p:column>
								</p:autoComplete>
			              </div>
			              <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;">
			                  <p:pickList value="#{promotionProgramBean.modelCustomerSetting}" var="theme" 
						                itemValue="#{theme}" itemLabel="#{theme.customer_name}"  styleClass="pickListClass" id="pickList"
						                 converter="pickListConverter" responsive="true">
						        <f:facet name="sourceCaption">Danh sách khách hàng</f:facet>
						        <f:facet name="targetCaption">Danh Sách khách hàng được chọn<span style="color:red;">*</span></f:facet>
						        <p:column >
						             <h:outputText value="#{theme.customer_name}" />
						        </p:column>
						     </p:pickList>
			              </div>
			              <div class="col-md-6" style="margin-top: 3px; margin-bottom: 10px; padding-left: 0px !important; padding-right:0px !important;">
			                 <p:inputText placeholder="Tìm kiếm khách hàng" value="#{promotionProgramBean.textSearch}" style="width:90%">
			                       <p:ajax event="keyup" delay="1000" listener="#{promotionProgramBean.searchCustomerSetting()}" update="pickList" />
			                 </p:inputText>
			              </div>
			              
			           </div>
				</div>
				<div class="col-md-12" style="padding:10px 0px !important;">
				    <p:commandButton  value="Cài đặt" update="menuformid:table3" actionListener="#{promotionProgramBean.settingCustomers()}" />
				</div>
		</h:form>
	</p:dialog>
	<p:dialog styleClass="dialogCus" resizable="false" width="350" style="overflow: initial;"
		closeOnEscape="true" header="Cài đặt khách hàng" widgetVar="dlgctkhcrud">
		<h:form id="dlgctkhcrud" style="width:100%;">
			   <div class="col-md-12 boxCus">
			           <div class="row">
			              <div class="col-md-12" style="padding-left:0px !important;padding-right:0px !important;">
			                 <div class="row">
			                    <label>Khách hàng<span style="color:red;">*</span></label>
			                 </div>
                          </div>
                            <div class="col-md-12" style="padding-left: 0px !important; padding-right: 0px !important; margin-bottom:5px;" >
                               <div class="row">
                                  <p:autoComplete style="width:100%;"
									value="#{promotionProgramBean.customerPromotionProgramCrud.customer}"
									converter="abstractConverter" minQueryLength="2" queryDelay="1000"
									completeMethod="#{promotionProgramBean.completeCustomerCommon}" var="p"
									itemLabel="#{p.customer_name}" itemValue="#{p}"
									forceSelection="true" onclick="this.select();">
										<p:column style="width:50px">
										   <h:outputText value="#{p.customer_code}" />
										</p:column>
										<p:column style="width:150px">
										   <h:outputText value="#{p.customer_name}" />
										 </p:column>
									</p:autoComplete>
                               </div>
                            </div>
                          <div class="col-md-12" style="padding-left:0px !important;padding-right:0px !important;">
                              <div class="row">
                                  <label>Chương trình khuyến mãi</label>
                              </div>
                          </div>
                           <div class="col-md-12" style="padding-left: 0px !important; padding-right: 0px !important; margin-bottom:5px;" >
                               <div class="row">
                                  <p:autoComplete style="width:100%;"
									value="#{promotionProgramBean.customerPromotionProgramCrud.promotion_program}"
									converter="abstractConverter" minQueryLength="2" queryDelay="1000" 
									completeMethod="#{promotionProgramBean.completePromotionProgram}" var="p"
									itemLabel="#{p.program_code}" itemValue="#{p}"
									forceSelection="true" onclick="this.select();">
									<p:column style="width:50px">
									   <h:outputText value="#{p.program_code}" />
									</p:column>
									<p:column style="width:70px">
									   <h:outputText value="#{p.effective_date}">
										<f:convertDateTime pattern="dd/MM/yyyy"/>
									  </h:outputText>
									</p:column>
									<p:column style="width:70px">
									   <h:outputText value="#{p.expiry_date}">
										<f:convertDateTime pattern="dd/MM/yyyy"/>
									  </h:outputText>
									</p:column>
									 <p:ajax event="itemSelect" listener="#{promotionProgramBean.changeDataDialogCDKH()}" update="effdate,exdate"  />
								  </p:autoComplete>
                               </div>
                          </div>
                          <div class="col-md-12" style="padding-left:0px !important;padding-right:0px !important;">
                              <div class="row">
                                  <div class="col-md-6" style="padding-left: 0px !important;padding-right: 5px !important;">
                                      <label>Ngày hiệu lực</label>
                                  </div>
                                  <div class="col-md-6" style="padding-left: 5px !important;padding-right: 0px !important;">
                                       <label>Ngày hết hạn</label>
                                  </div>
                              </div>
                          </div>
                          <div class="col-md-12" style="padding-left:0px !important;padding-right:0px !important; margin-bottom:5px;">
                              <div class="row">
                                  <div class="col-md-6" style="padding-left: 0px !important;padding-right: 5px !important;">
                                     <p:calendar id="effdate" value="#{promotionProgramBean.customerPromotionProgramCrud.effective_date}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true"/>
                                  </div>
                                  <div class="col-md-6" style="padding-left: 5px !important;padding-right: 0px !important;">
                                      <p:calendar id="exdate" value="#{promotionProgramBean.customerPromotionProgramCrud.expiry_date}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true"/>
                                  </div>
                              </div>
                          </div>
                          <div class="col-md-12" style="padding-left: 0px !important; padding-right: 0px !important;" >
                               <div class="row">
                                    <p:selectBooleanCheckbox  value="#{promotionProgramBean.customerPromotionProgramCrud.disable}" itemLabel="Không còn sử dụng" />
                               </div>
                          </div>
			           </div>
				</div>
				<div class="col-md-12" style="padding:10px 0px !important;">
				    <p:commandButton  value="Lưu/Cập nhật" update="dlgctkhcrud,menuformid:table3" actionListener="#{promotionProgramBean.saveOrUpdateCustomerPromotionProgram()}" />
				</div>
		</h:form>
	</p:dialog>
	<p:dialog styleClass="dialogCus" resizable="false" style="overflow: initial;width:100%;max-width: min-content;min-width: 384px;"
		closeOnEscape="true" header="Nạp file CT.Khuyến mãi" widgetVar="dlgup1">
		<h:form id="dlgup1" enctype="multipart/form-data">
			   <div class="col-md-12 boxCus">
		              <div class="col-md-12" style="margin-bottom: 10px;">
		                 <div class="row">
		                     <div class="col-md-6">
			                     <p:selectBooleanCheckbox value="#{promotionProgramBean.rewrite}" itemLabel="Ghi lại dữ liệu" />
		                     </div>
		                     <div class="col-md-6">
		                         <a href="#{request.contextPath}/resources/upload/filemau/file_mau_ct_khuyen_mai1.xlsx" style="color: #0077b3;text-decoration: underline;">Xem file excel mẫu</a>
					         </div>
		                 </div>
		              </div>
		              <div class="col-md-12">
		                 <div class="row">
							<p:fileUpload style="width: max-content;"
							    dragDropSupport="true"  allowTypes="/(\.|\/)(xls|xlsx)$/"
								label="Chọn file" cancelLabel="Huỷ" update=":messages,"
								uploadLabel="Tải lên" multiple="false" 
								fileUploadListener="#{promotionProgramBean.loadExcelCTKM}" mode="advanced" process=""/>
							 
		                 </div>
		              </div>
			    </div>
		</h:form>
	</p:dialog>
	<p:dialog styleClass="dialogCus" resizable="false" style="overflow: initial;width:100%;max-width: min-content;min-width: 384px;"
		closeOnEscape="true" header="Cài đặt CTKM cho khách hàng" widgetVar="dlgup2">
		<h:form id="dlgup2" enctype="multipart/form-data">
			   <div class="col-md-12 boxCus">
		              <div class="col-md-12" style="margin-bottom: 10px;">
		                 <div class="row">
		                     <div class="col-md-6">
			                     <p:selectBooleanCheckbox value="#{promotionProgramBean.rewrite}" itemLabel="Ghi lại dữ liệu" />
		                     </div>
		                     <div class="col-md-6">
		                         <a href="#{request.contextPath}/resources/upload/filemau/file_cai_dat_ct_khuyen_mai.xlsx" style="color: #0077b3;text-decoration: underline;">Xem file excel mẫu</a>
					         </div>
		                 </div>
		              </div>
		              <div class="col-md-12">
		                 <div class="row">
							<p:fileUpload style="width: max-content;"
							    dragDropSupport="true"  allowTypes="/(\.|\/)(xls|xlsx)$/"
								label="Chọn file" cancelLabel="Huỷ" update=":messages,"
								uploadLabel="Tải lên" multiple="false" 
								fileUploadListener="#{promotionProgramBean.loadExcelCDCTKM}" mode="advanced" process=""/>
							 
		                 </div>
		              </div>
			    </div>
		</h:form>
	</p:dialog>
	</ui:define>
</ui:composition>