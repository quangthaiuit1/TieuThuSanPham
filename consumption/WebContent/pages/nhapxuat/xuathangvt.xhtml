<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:h="http://java.sun.com/jsf/html" template="/pages/home.xhtml">
	<ui:define name="content">
		<h3 style="margin: 0px">Xuất hàng theo vị trí</h3>
		<p:separator />
	<div class="ui-md-12" >
		<h:form id="menuformid">
		       <p:tabView id="tabview1" styleClass="clearfix label12 tabview_lix">
		       <p:tab id="tab2"  title="Chi tiết hóa đơn" >
		           <h:panelGroup id="tab2real" styleClass="clearfix" style="background-color: #eeeeee;width: 100%;height: auto;padding-top: 20px;padding-right: 10px;display: inline-block;padding-left: 10px;padding-bottom: 20px;">
		               <div class="wrapdetail" style="background-color: #eeeeee;width: 100%;height: auto;">
		               <div class="col-md-12" style=" padding-left: 0px !important;padding-right:0px !important;background-color:white;padding-top: 15px;">
		               <div class="col-md-12" style=" padding-left: 0px !important;padding-right:0px !important;">
		                   <div class="row">
		                      <div class="col-md-3">
		                         <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                            <label>Số chứng từ<span style="color:red;">*</span></label>
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                               <label>Mã hóa đơn<span style="color:red;">*</span></label>
		                          </div>
		                      </div>
		                      <div class="col-md-3">
		                          <label>HT thanh toán</label>
		                      </div>
		                      <div class="col-md-3">
		                          <label>Loại nhập xuất<span style="color:red;">*</span></label>
		                      </div>
		                      <div class="col-md-3">
		                          <label>Người tạo<span style="color:red;">*</span></label>
		                      </div>
		                   </div>
		                   <div class="row">
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                             <p:inputText readonly="true" value="#{invoicePosBean.invoicePosCrud.voucher_code}" style="width:100%;" />
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                               <p:inputText readonly="true" value="#{invoicePosBean.invoicePosCrud.invoice_code}" style="width:100%;" />
		                          </div>
		                         
		                      </div>
		                      <div class="col-md-3">
		                          <p:selectOneMenu 
										value="#{invoicePosBean.invoicePosCrud.payment_method}"
										converter="abstractConverter" effect="fade" var="t"
										style="width:100%;">
										<f:selectItem itemLabel="--select--" itemValue="#{null}" />
										<f:selectItems value="#{invoicePosBean.listPaymentMethod}"
											var="theme" itemLabel="#{theme.method_name}"
											itemValue="#{theme}" />
										<p:column>
											<h:outputText value="#{t==null ? '--select--' : t.method_name}" />
										</p:column>
									</p:selectOneMenu>
		                      </div>
		                      <div class="col-md-3">
		                          <p:selectOneMenu 
										value="#{invoicePosBean.invoicePosCrud.ie_categories}"
										converter="abstractConverter" effect="fade" var="t"
										style="width:100%;">
										<f:selectItem itemLabel="--select--" itemValue="#{null}" />
										<f:selectItems value="#{invoicePosBean.listIECategories}"
											var="theme" itemLabel="#{theme.content}"
											itemValue="#{theme}" />
										<p:column>
											<h:outputText value="#{t.code}" />
										</p:column>
										<p:column>
											<h:outputText value="#{t==null ? '--select--' : t.content}" />
										</p:column>
									</p:selectOneMenu>
		                      </div>
		                      <div class="col-md-3">
		                           <p:inputText readonly="true" value="#{invoicePosBean.invoicePosCrud.created_by}" style="width:100%;" />
		                      </div>
		                   </div>
		               </div>
		               <div class="col-md-12" style="margin-top: 5px; padding-left: 0px !important;padding-right:0px !important;">
		                   <div class="row">
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                            <label>Đơn hàng<span style="color:red;">*</span></label>
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                               <label>Số đơn hàng</label>
		                          </div>
		                      </div>
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                             <label>Số xe</label>
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                               <label>Tỉ lệ thuế</label>
		                          </div>
		                      </div>
		                      <div class="col-md-3">
		                          <label>Kho<span style="color:red;">*</span></label>
		                      </div>
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                            <label>Số LĐĐ</label>
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                               <label>P/O</label>
		                          </div>
		                      </div>
		                      
		                   </div>
		                   <div class="row">
		                      <div class="col-md-3">
		                           <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                               <p:inputText readonly="true" value="#{invoicePosBean.invoicePosCrud.order_code}" />
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                               <p:inputText readonly="true" value="#{invoicePosBean.invoicePosCrud.order_voucher}" />
		                          </div>
		                      </div>
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                             <p:autoComplete style="width:100%;"
										value="#{invoicePosBean.invoicePosCrud.car}" queryDelay="1000"
										maxResults="35"
										converter="abstractConverter" minQueryLength="2" 
										completeMethod="#{invoicePosBean.completeCar}" var="p"
										itemLabel="#{p.license_plate}" itemValue="#{p}"
										forceSelection="true" onclick="this.select();">
										<p:column style="width:50px">
										   <h:outputText value="#{p.license_plate}" />
										</p:column>
										<p:column style="width:150px">
										    <h:outputText value="#{p.driver}" />
										 </p:column>
									</p:autoComplete>
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                                <p:inputNumber   onclick="this.select()" value="#{invoicePosBean.invoicePosCrud.tax_value}" styleClass="intputnumcc" style="width:100%;"
											minValue="0" decimalPlaces="4" decimalSeparator="," maxValue="1000000" emptyValue="0"
					                 thousandSeparator="." />
		                          </div>
		                      </div>
		                      <div class="col-md-3">
		                          <p:selectOneMenu 
										value="#{invoicePosBean.invoicePosCrud.warehouse}"
										converter="abstractConverter" effect="fade" var="t"
										style="width:100%;">
										<f:selectItem itemLabel="--select--" itemValue="#{null}" />
										<f:selectItems value="#{invoicePosBean.listWarehouse}"
											var="theme" itemLabel="#{theme.name}"
											itemValue="#{theme}" />
										<p:column>
											<h:outputText value="#{t.code}" />
										</p:column>
										<p:column>
											<h:outputText value="#{t==null ? '--select--' : t.name}" />
										</p:column>
									</p:selectOneMenu>
		                      </div>
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                              <p:inputText value="#{invoicePosBean.invoicePosCrud.movement_commands_no}" style="width:100%;" />
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                                <p:inputText  value="#{invoicePosBean.invoicePosCrud.po_no}" style="width:100%;" />
		                          </div>
			                    </div>
		                   </div>
		               </div>
		               <div class="col-md-12" style="margin-top: 5px; padding-left: 0px !important;padding-right:0px !important;">
		                   <div class="row">
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                            <label>CT.Đơn giá</label>
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                               <label>CT.Khuyến mãi</label>
		                          </div>
		                      </div>
		                       <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                            <label>Tỉ lệ CK</label>
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                               <label>Số HĐVCNB</label>
		                          </div>
		                      </div>
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                            <label>Số HĐMB</label>
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                               <label>Số SerieHD</label>
		                          </div>
		                      </div>
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                             <label>Ngày giao hàng</label>
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                               <label>t/g lên hàng(phút)</label>
		                          </div>
		                      </div>
		                   </div>
		                   <div class="row">
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                               <p:inputText readonly="true"  value="#{invoicePosBean.invoicePosCrud.pricing_program.program_code}" style="width:100%;" />
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                             <p:inputText readonly="true" value="#{invoicePosBean.invoicePosCrud.promotion_program.program_code}" style="width:100%;" />
		                          </div>
		                      </div>
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                               <p:inputNumber   onclick="this.select()" value="#{invoicePosBean.invoicePosCrud.discount}" styleClass="intputnumcc" style="width:100%;"
											minValue="0" decimalPlaces="4" decimalSeparator="," maxValue="1000000" emptyValue="0"
					                 thousandSeparator="." />
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                              <p:inputText readonly="true"  value="#{invoicePosBean.invoicePosCrud.freight_contract.contract_code}" style="width:100%;" />
		                              <p:commandButton   styleClass="buttonhopdong"  update="dlg2"
										icon="fa fa-list" process="@this" action="#{invoicePosBean.showDialogPickHDVC()}"   >
									  </p:commandButton>
		                          </div>
		                      </div>
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                             <p:inputText  value="#{invoicePosBean.invoicePosCrud.contract_no}" style="width:100%;" />
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                              <p:inputText  value="#{invoicePosBean.invoicePosCrud.invoice_serie}" style="width:100%;" />
		                          </div>
		                      </div>
		                      <div class="col-md-3">
		                          <div class="col-md-6" style="padding-left:0px !important; padding-right:3px !important;">
		                              <p:calendar value="#{invoicePosBean.invoicePosCrud.delivery_date}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true"/>
		                          </div>
		                          <div class="col-md-6" style="padding-left:3px !important; padding-right:0px !important;">
		                              <p:inputNumber   onclick="this.select()" value="#{invoicePosBean.invoicePosCrud.time_up_goods}" styleClass="intputnumcc" style="width:100%;"
											minValue="0" decimalPlaces="0" decimalSeparator="," maxValue="1000000" emptyValue="0"
					                 thousandSeparator="." />
		                          </div>
		                      </div>
		                   </div>
		               </div>
		               <div class="col-md-12" style="margin-top: 5px; padding-left: 0px !important;padding-right:0px !important;">
		                   <div class="row">
		                      <div class="col-md-3">
		                          <label>Thủ kho<span style="color:red;">*</span></label>
		                      </div>
		                      <div class="col-md-3">
		                          <label>Bốc xếp</label>
		                      </div>
		                      <div class="col-md-3">
		                          <label>Cảng đến</label>
		                      </div>
		                      <div class="col-md-3">
		                          <label>Hình thức lên hàng</label>
		                      </div>
		                   </div>
		                   <div class="row">
		                         <div class="col-md-3">
			                        <p:selectOneMenu 
										value="#{invoicePosBean.invoicePosCrud.stocker}"
										converter="abstractConverter" effect="fade" var="t"
										style="width:100%;">
										<f:selectItem itemLabel="--select--" itemValue="#{null}" />
										<f:selectItems value="#{invoicePosBean.listStocker}"
											var="theme" itemLabel="#{theme.stocker_code}"
											itemValue="#{theme}" />
										<p:column>
											<h:outputText value="#{t.stocker_name}" />
										</p:column>
										<p:column>
											<h:outputText value="#{t==null ? '--select--' : t.stocker_name}" />
										</p:column>
									</p:selectOneMenu>
		                         </div>
			                      <div class="col-md-3">
			                          <p:selectOneMenu 
										value="#{invoicePosBean.invoicePosCrud.stevedore}"
										converter="abstractConverter" effect="fade" var="t"
										style="width:100%;">
										<f:selectItem itemLabel="--select--" itemValue="#{null}" />
										<f:selectItems value="#{invoicePosBean.listStevedores}"
											var="theme" itemLabel="#{theme.content}"
											itemValue="#{theme}" />
										<p:column>
											<h:outputText value="#{t==null ? '--select--' : t.content}" />
										</p:column>
									</p:selectOneMenu>
			                      </div>
			                      <div class="col-md-3">
			                          <p:selectOneMenu 
										value="#{invoicePosBean.invoicePosCrud.harbor_category}"
										converter="abstractConverter" effect="fade" var="t"
										style="width:100%;">
										<f:selectItem itemLabel="--select--" itemValue="#{null}" />
										<f:selectItems value="#{invoicePosBean.listHarborCategory}"
											var="theme" itemLabel="#{theme.harbor_name}"
											itemValue="#{theme}" />
										<p:column>
											<h:outputText value="#{t==null ? '--select--' : t.harbor_name}" />
										</p:column>
									</p:selectOneMenu>
			                      </div>
			                      <div class="col-md-3">
			                           <p:selectOneMenu 
										value="#{invoicePosBean.invoicePosCrud.form_up_goods}"
										converter="abstractConverter" effect="fade" var="t"
										style="width:100%;">
										<f:selectItem itemLabel="--select--" itemValue="#{null}" />
										<f:selectItems value="#{invoicePosBean.listFormUpGoods}"
											var="theme" itemLabel="#{theme.content}"
											itemValue="#{theme}" />
										<p:column>
											<h:outputText value="#{t==null ? '--select--' : t.content}" />
										</p:column>
									   </p:selectOneMenu>
			                      </div>
		                   </div>
		               </div>
		               <div class="col-md-12" style="margin-top: 5px; padding-left: 0px !important;padding-right:0px !important;">
		                   <div class="row">
		                      <div class="col-md-3">
		                          <label>Khách hàng<span style="color:red;">*</span></label>
		                      </div>
		                      <div class="col-md-3">
		                          <label>Ghi chú</label>
		                      </div>
		                      <div class="col-md-3">
		                         <label>Người vận chuyển</label>
		                      </div>
		                      <div class="col-md-3">
		                      </div>
		                   </div>
		                   <div class="row">
		                         <div class="col-md-3">
			                         <p:autoComplete style="width:100%;" title="#{invoicePosBean.invoicePosCrud.customer.customer_name}"
										value="#{invoicePosBean.invoicePosCrud.customer}" 
										converter="abstractConverter" minQueryLength="2" 
										completeMethod="#{invoicePosBean.completeCustomer}" var="p"
										itemLabel="#{p.customer_name}" itemValue="#{p}"
										forceSelection="true" onclick="this.select();">
										<p:column style="width:50px">
										   <h:outputText value="#{p.customer_code}" />
										</p:column>
										<p:column style="width:150px">
										    <h:outputText value="#{p.customer_name}" />
										 </p:column>
										</p:autoComplete>
		                         </div>
			                      <div class="col-md-3">
			                          <p:selectOneMenu 
										value="#{invoicePosBean.invoicePosCrud.note}" effect="fade" style="width:100%;">
										<f:selectItem itemLabel="--select--" itemValue="" />
										<f:selectItem itemLabel="Hàng khuyến mãi" itemValue="Hàng khuyến mãi" />
										<f:selectItem itemLabel="Hàng giới thiệu sản phẩm" itemValue="Hàng giới thiệu sản phẩm" />
										<f:selectItem itemLabel="Hàng quản cáo sản phẩm" itemValue="Hàng quản cáo sản phẩm" />
										<f:selectItem itemLabel="Hàng mẫu" itemValue="Hàng mẫu" />
									</p:selectOneMenu>
			                      </div>
			                      <div class="col-md-3">
			                          <p:autoComplete style="width:100%;" title="#{invoicePosBean.invoicePosCrud.carrier.carrier_name}"
										value="#{invoicePosBean.invoicePosCrud.carrier}" queryDelay="900"
										converter="abstractConverter" minQueryLength="2" 
										completeMethod="#{invoicePosBean.completeCarrier}" var="p"
										itemLabel="#{p.carrier_name}" itemValue="#{p}"
										forceSelection="true" onclick="this.select();">
										<p:column style="width:50px">
										   <h:outputText value="#{p.carrier_code}" />
										</p:column>
										<p:column style="width:150px">
										    <h:outputText value="#{p.carrier_name}" />
										 </p:column>
										</p:autoComplete>
			                      </div>
			                      <div class="col-md-3">
			                            <p:selectBooleanCheckbox  itemLabel="Đã thanh toán" value="#{invoicePosBean.invoicePosCrud.payment}" />
			                            <p:selectBooleanCheckbox itemLabel="Ngoài giờ" value="#{invoicePosBean.invoicePosCrud.timeout}" />
			                      </div>
		                   </div>
		               </div>
		               <div class="col-md-12" style="margin-top: 5px; padding-left: 0px !important;padding-right:0px !important;">
		                   <div class="row">
		                      <div class="col-md-3">
		                          <label>Lưu ý KH</label>
		                      </div>
		                      <div class="col-md-3">
		                          <label>Nơi đến</label>
		                      </div>
		                      <div class="col-md-3">
		                          <label>Nội dung vận chuyển</label>
		                      </div>
		                      <div class="col-md-3">
		                      </div>
		                   </div>
		                   <div class="row">
		                         <div class="col-md-3">
			                            <p:inputTextarea readonly="true" styleClass="textareap" value="#{invoicePosBean.invoicePosCrud.customer.note}" rows="2">
			                          </p:inputTextarea>
		                         </div>
			                      <div class="col-md-3">
			                           <p:inputTextarea readonly="true" styleClass="textareap" value="#{invoicePosBean.invoicePosCrud.delivery_pricing.address}" rows="2">
			                          </p:inputTextarea>
			                      </div>
			                      <div class="col-md-3">
			                          <p:inputTextarea  styleClass="textareap" value="#{invoicePosBean.invoicePosCrud.transport_content}" rows="2">
			                          </p:inputTextarea>
			                      </div>
			                      <div class="col-md-3">
			                           <p:fieldset id="tstatus" legend="Trạng thái" 
								          styleClass="fieldsetclass2 label12 classfixtopfieldset">
								          <h:outputText rendered="#{invoicePosBean.invoicePosCrud.status==0}" style="color:red;" value="Phiếu chờ xuất" />
								          <h:outputText rendered="#{invoicePosBean.invoicePosCrud.status==1}"  style="color:#03A9F4;" value="Hoàn thành" />
								      </p:fieldset>
			                      </div>
		                   </div>
		               </div>
		               <div class="col-md-12" style="margin-top: 18px; padding-left: 0px !important;padding-right:0px !important;">
		                   <div class="row">
		                      <div class="col-md-3" style="padding-right:5px !important;">
		                         <p:fieldset id="tongthue" legend="Tiền thuế" 
							          styleClass="fieldsetclass2 label12 classfixtopfieldset">
							          <span> #{invoicePosBean.formatHandler.getNumberFormat(invoicePosBean.sumInvoice()*invoicePosBean.invoicePosCrud.tax_value,1000)}</span>
							      </p:fieldset>
							  </div>
							  <div class="col-md-3" style="padding-left:5px !important;">
		                         <p:fieldset id="tongtien" legend="Tổng tiền" 
							          styleClass="fieldsetclass2 label12 classfixtopfieldset">
							          <span>#{invoicePosBean.formatHandler.getNumberFormat(invoicePosBean.sumInvoice(),1000)}</span>
							      </p:fieldset>
		                      </div>
		                   </div>
		                   <div class="row" style="margin-top: 20px;text-align: right;margin-bottom: 10px;">
			                      <p:commandLink   process="tab2real" update="tab2real,tablesp"   action="#{invoicePosBean.saveOrUpdateInvoiceTemp()}" styleClass="btn_primmary" style="margin-left:10px; " >
					                    <i class="fa fa-floppy-o" aria-hidden="true"></i><span>Lưu/Cập nhật</span>
					              </p:commandLink>
					              <p:commandLink process="@this" update="tab2real"   action="#{invoicePosBean.createdNew()}" styleClass="btn_printtt" style="margin-left:10px;" >
					                    <i class="fa fa-file-text-o" aria-hidden="true"></i><span>Tạo mới</span>
					              </p:commandLink>
					              <p:commandLink process="@this"  action="#{invoicePosBean.exportPDF()}" styleClass="btn_printtt" style="margin-left:10px; padding-left:25px;padding-right:25px;" >
					                    <i class="fa fa-print" aria-hidden="true"></i><span>In</span>
					              </p:commandLink>
			                      <p:commandLink process="@this"  action="#{invoicePosBean.saveOrUpdateInvoice()}" styleClass="btn_primmary" style="margin-left:10px; margin-right:10px;" >
					                    <i class="fa fa-chevron-down" aria-hidden="true"></i><span>Hoàn thành</span>
					              </p:commandLink>
			                      <p:commandLink process="@this" update="tstatus,:messages"  action="#{invoicePosBean.destroyInvoice()}" styleClass="btn_destroy" style="margin-right:10px;"  >
					                    <i class="fa fa-times" aria-hidden="true"></i><span>Hủy hóa đơn</span>
					              </p:commandLink>
		                   </div>
		                   <div class="row" style="margin-bottom: 10px;">
		                       <div class="col-md-12">
		                           <h:panelGroup id="contentNoSave" styleClass="pull-right" rendered="#{invoicePosBean.invoicePosCrud.id==0}">
		                               <h:outputText style="color:red;font-weight:bold; font-size:13px;" value="Đơn hàng chưa được lưu" />
		                           </h:panelGroup>
		                       </div>
		                   </div>
		               </div>
		               </div>
		               </div>
		               <div class="col-md-12" style="margin-top: 10px; padding-left: 0px !important;padding-right:0px !important; background-color: white;     padding-top: 20px;">
		                   <div class="row">
		                      <p:fieldset legend="Sản phẩm hóa đơn" styleClass="fieldsetclass label12 borderfsnone" toggleable="true" toggleSpeed="500" collapsed="false" style="margin-bottom:10px;" >
							    <div class="col-md-12">
							      <div class="row">
							       <p:commandButton action="#{invoicePosBean.deleteInvoiceDetail()}" style="padding: 3px 14px 3px 16px !important;font-size:11px !important;" styleClass="buttonaddrow"
							       update="tablect,menuformid:tabview1:tongthue,menuformid:tabview1:tongtien"   icon="fa fa-trash">
							          <p:confirm icon="ui-icon-alert" />
							        </p:commandButton>
							       <p:commandButton process="@this" update="idlg1" action="#{invoicePosBean.showAddInvoiceDetail()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Thêm"
					              icon="fa fa-plus" />
							       <p:commandButton  update="idlg1" action="#{invoicePosBean.showEditInvoiceDetail()}" style="padding:4px !important;" styleClass="buttonaddrow" value="Chỉnh sửa"
					              icon="fa fa-pencil" />
									</div>
							   </div>
							   <div class="col-md-12">
							       <div class="row">
								       <p:dataTable value="#{invoicePosBean.listWrapInvoiceDetailPosReqInfo}" 
										paginatorPosition="bottom" rowsPerPageTemplate="90,180,250"  rowIndexVar="indexd"
										paginator="true" rowKey="#{item.invoice_detail_pos.id}" style="width:100%;" styleClass="tablenhapsp tableright0"
										selection="#{invoicePosBean.wrapInvoiceDetailPosSelect}" scrollable="true"
										selectionMode="single" id="tablect" scrollWidth=""   expandedRow="true"
										scrollHeight="370" widgetVar="tablect" 
										var="item">
										<p:ajax event="rowDblselect" listener="#{invoicePosBean.showEditInvoiceDetail()}" update="idlg1" />
										<p:column width="20" styleClass="textcenter">
								            <p:rowToggler  />
								        </p:column>
								        <p:column width="30" styleClass="textcenter">
										   <p:commandLink update="dlgexport,dlgheader" styleClass="btnexportpos" action="#{invoicePosBean.showDialogBatchPos(item)}">
										      <i class="fa fa-external-link" aria-hidden="true"></i>
										   </p:commandLink>
										</p:column>
										<p:column headerText="ID" width="40" styleClass="textcenter">
											<h:outputText value="#{item.invoice_detail_pos.id}" />
										</p:column>
										<p:column headerText="Mã SP" width="45">
											<h:outputText value="#{item.invoice_detail_pos.product.product_code}" />
										</p:column>
										<p:column headerText="Sản phẩm" width="250">
											<h:outputText style="white-space: initial;" value="#{item.invoice_detail_pos.product.product_name}" />
										</p:column>
										<p:column headerText="Số lượng" width="55" styleClass="textright">
											<h:outputText value="#{invoicePosBean.formatHandler.getNumberFormat(item.invoice_detail_pos.quantity,1000)}" />
										</p:column>
										<p:column headerText="Thực xuất" width="60" styleClass="textright">
											<h:outputText id="realExport" style="color:#ed5c6a;font-weight: bold;" value="#{invoicePosBean.formatHandler.getNumberFormat(item.invoice_detail_pos.real_quantity,1)}" />
										</p:column>
										<p:column headerText="Đơn giá" width="55" styleClass="textright">
											<h:outputText value="#{item.invoice_detail_pos.unit_price==0 ? '' :invoicePosBean.formatHandler.getNumberFormat(item.invoice_detail_pos.unit_price,1000)}" />
										</p:column>
										<p:column headerText="Số tiền" width="70" styleClass="textright">
											<h:outputText value="#{item.invoice_detail_pos.quantity*item.invoice_detail_pos.unit_price ==0 ? '' :invoicePosBean.formatHandler.getNumberFormat(item.invoice_detail_pos.quantity*item.invoice_detail_pos.unit_price,1000)}" />
										</p:column>
										<p:column headerText="Qui cách" width="80">
											<h:outputText style="font-size:11px;" value="#{invoicePosBean.formatHandler.getNumberFormat(item.invoice_detail_pos.product.specification,1000)} #{item.invoice_detail_pos.product.unit}/#{item.invoice_detail_pos.product.packing_unit}" />
										</p:column>
										<p:column headerText="Maspdh" width="40">
											<h:outputText value="#{item.invoice_detail_pos.productdh_code}" />
										</p:column>
										<p:column headerText="IDHĐBH" width="50" styleClass="textcenter">
											<h:outputText value="#{item.invoice_detail_pos.detail_own_id}" />
										</p:column>
										<p:column headerText="Đơn giá N.tệ" width="80">
											<h:outputText value="#{item.invoice_detail_pos.foreign_unit_price==0 ? '' :invoicePosBean.formatHandler.getNumberFormat(item.invoice_detail_pos.foreign_unit_price,1000)}" />
										</p:column>
										<p:column headerText="Số tiền N.tệ" width="80">
											<h:outputText value="#{item.invoice_detail_pos.total_foreign_amount==0 ? '' :invoicePosBean.formatHandler.getNumberFormat(item.invoice_detail_pos.total_foreign_amount,1000)}" />
										</p:column>
										<p:rowExpansion styleClass="parentPosition">
										   <p:dataTable value="#{item.list_export_batch_pos}" style=" width:75%; min-height:100px !important; font-size:11px !important;"
												paginatorPosition="bottom" rowsPerPageTemplate="90,180,250" 
												 styleClass="tableinner" 
												paginator="true" rowKey="#{item2.id}"   id="tableInner"
												 widgetVar="tableInner" 
												var="item2">
												<p:column width="5" styleClass="textcenter">
												    <p:commandLink update="tableInner,messages" styleClass="trash_del" style="font-size:15px !important;" process="@this" actionListener="#">
													   <span class="fa fa-trash-o"></span>
													</p:commandLink>
												</p:column>
												<p:column headerText="ID" width="15" styleClass="textcenter">
													<h:outputText  value="#{item2.id}" />
												</p:column>
												<p:column headerText="Kho nhập" width="90" styleClass="textcenter">
													<h:outputText  value="#{item2.product_pos.pos.warehouse.code}-#{item2.product_pos.pos.warehouse.name}" />
												</p:column>
												<p:column headerText="Pallet/thùng" width="40" styleClass="textcenter">
													<h:outputText value="#{invoicePosBean.formatHandler.getNumberFormat(item.invoice_detail_pos.product.box_quantity,100)}" />
												</p:column>
												<p:column headerText="Lô hàng" width="40" styleClass="textcenter">
													<h:outputText value="#{item2.product_pos.batch_pos.batch_code}" />
												</p:column>
												<p:column headerText="Vị trí" width="40" styleClass="textcenter">
													<h:outputText value="#{item2.product_pos.pos.barcode}" />
												</p:column>
												<p:column headerText="Số thùng xuất" width="40" styleClass="textright">
												     <h:outputText value="#{invoicePosBean.formatHandler.getNumberFormat(item2.quantity_export_box,1000)}" />
												</p:column>
											 </p:dataTable>
										</p:rowExpansion>
									</p:dataTable>
								 </div>
							   </div>
								</p:fieldset>
		                   </div>
		               </div>
		           </h:panelGroup>
		       </p:tab>
		       <p:tab id="tab1"  title="Danh sách hóa đơn"  >
		           <div class="col-md-12"  style="padding-left:0px !important; padding-right: 0px !important;background-color: #eeeeee;padding-top: 15px;">
	              <div class="col-md-12">
	                   <p:commandButton id="xoact"  process="@this"  action="#" style="padding: 3px 14px 3px 16px !important;font-size:11px !important;" styleClass="buttonaddrow"
				       update=":messages,tablesp"   icon="fa fa-trash">
				          <p:confirm icon="ui-icon-alert" />
				       </p:commandButton>
					  <p:commandButton id="idorder" icon="fa fa-search" 
					  style="padding:4px !important;" styleClass="buttonaddrow" value="Tìm kiếm" />
	                  <p:overlayPanel id="imagePanel" for="idorder" hideEffect="fade" dismissable="false"
								widgetVar="panelsearch" style="width:360px;">
						<div class="col-md-12"
											style="border: 1px solid #ccc; border-radius: 6px; margin-bottom: 5px !important;">
							    <div class="col-md-12" style="padding-top:10px !important;padding-left: 0px !important; padding-right: 0px !important;">
	                                   <div class="row">
	                                       <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important;">
	                                           <label>Từ ngày</label>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 5px !important; padding-right: 0px !important;">
	                                           <label>Đến ngày</label>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
	                                          <p:calendar value="#{invoicePosBean.fromDateSearch}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true"/>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 5px !important; padding-right: 0px !important; margin-bottom:5px;" >
	                                            <p:calendar value="#{invoicePosBean.toDateSearch}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true"/>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important;">
	                                           <label>Mã hóa đơn</label>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 5px !important; padding-right: 0px !important;">
	                                           <label>Số chứng từ</label>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
	                                          <p:inputText value="#{invoicePosBean.invoiceCodeSearch}" style="width:100%" />
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 5px !important; padding-right: 0px !important; margin-bottom:5px;" >
	                                           <p:inputText value="#{invoicePosBean.voucherCodeSearch}" style="width:100%" />
	                                       </div>
	                                       <div class="col-md-12" style="padding-left: 0px !important;padding-right:0px !important;">
	                                           <label>Khách hàng</label>
	                                       </div>
	                                       <div class="col-md-12" style="padding-left: 0px !important; padding-right: 0px !important; margin-bottom:5px;" >
	                                           <p:autoComplete style="width:100%;"
													value="#{invoicePosBean.customerSearch}"
													converter="abstractConverter" minQueryLength="2" 
													completeMethod="#{invoicePosBean.completeCustomer}" var="p"
													itemLabel="#{p.customer_name}" itemValue="#{p}"
													forceSelection="true" onclick="this.select();">
													<p:column style="width:50px">
													   <h:outputText value="#{p.customer_code}" />
													</p:column>
													<p:column style="width:150px">
													    <h:outputText value="#{p.customer_name}" />
													 </p:column>
												</p:autoComplete>
	                                       </div>
	                                       <div class="col-md-12" style="padding-left:0px !important; padding-right:0px !important; ">
	                                           <label>Loại xuất nhập</label>
	                                       </div>
	                                       <div class="col-md-12" style="padding-left: 0px !important; padding-right: 0px !important; margin-bottom:5px;" >
	                                          <p:selectOneMenu 
													value="#{invoicePosBean.ieCategoriesSearch}"
													converter="abstractConverter" effect="fade" var="t"
													style="width:100%;">
													 <f:selectItem itemLabel="Tất cả" itemValue="#{null}" />
													<f:selectItems value="#{invoicePosBean.listIECategories}"
														var="theme" itemLabel="#{theme.content}"
														itemValue="#{theme}" />
													<p:column>
														<h:outputText value="#{t.code}" />
													</p:column>
													<p:column>
														<h:outputText value="#{t==null ? 'Tất cả' : t.content}" />
													</p:column>
												</p:selectOneMenu>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 0px !important;padding-right: 5px !important;">
	                                           <label>P/O</label>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 5px !important; padding-right:0px !important;">
	                                           <label>Mã đơn hàng</label>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
											    <p:inputText value="#{invoicePosBean.poNoSearch}" style="width:100%" />
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
											    <p:inputText value="#{invoicePosBean.orderCodeSearch}" style="width:100%" />
	                                       </div>
	                                        <div class="col-md-6" style="padding-left: 0px !important;padding-right: 5px !important;">
	                                           <label>Số đơn hàng</label>
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 5px !important; padding-right:0px !important;">
	                                           <label>Trạng thái</label>
	                                       </div>
	                                        <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
											    <p:inputText value="#{invoicePosBean.orderVoucherSearch}" style="width:100%;" />
	                                       </div>
	                                       <div class="col-md-6" style="padding-left: 0px !important; padding-right: 5px !important; margin-bottom:5px;" >
											    <p:selectOneMenu 
													value="#{invoicePosBean.statusSearch}"
													converter="integerConverter" effect="fade" var="t"
													style="width:100%;">
													 <f:selectItem itemLabel="Tất cả" itemValue="-1" />
										            <f:selectItem itemLabel="Phiếu tạm" itemValue="1" />
										            <f:selectItem itemLabel="Đã hoàn thành" itemValue="0" />
												</p:selectOneMenu>
	                                       </div>
	                                        <div class="col-md-12" style="padding-left: 0px !important;padding-right: 0px !important;">
	                                           <label>Trạng thái thanh toán</label>
	                                       </div>
	                                        <div class="col-md-12" style="padding-left: 0px !important;padding-right: 0px !important;margin-bottom:5px;">
	                                           <p:selectOneMenu 
													value="#{invoicePosBean.paymentSearch}"
													converter="integerConverter" effect="fade" var="t"
													style="width:100%;">
													 <f:selectItem itemLabel="Tất cả" itemValue="-1" />
										            <f:selectItem itemLabel="Chưa thanh toán" itemValue="1" />
										            <f:selectItem itemLabel="Đã thanh toán" itemValue="0" />
												</p:selectOneMenu>
	                                       </div>
	                                   </div>
	                                 </div>
						  </div>
							<div class="col-md-12" style="padding-left: 0px !important;padding-right: 0px !important; margin-bottom: 5px;">
							   <div class="pull-right">
									<p:commandButton value="Tìm" process="imagePanel" 
									icon="ui-icon-search" oncomplete="PF('panelsearch').hide()"
									actionListener="#{invoicePosBean.search()}"
									update="tablesp" />
								</div>
							</div>
					  </p:overlayPanel>
	              </div>
	              <div class="col-md-12" style="margin-top: 3px;">
	                <p:dataTable value="#{invoicePosBean.listInvoicePos}" lazy="true"
							paginatorPosition="bottom" styleClass="tablenhapsp"
							paginator="true" rowKey="#{item.id}" id="tablesp" style="width:100%;"
							scrollable="true" scrollHeight="700"  paginatorTemplate="{Exporters}"
							selection="#{invoicePosBean.invoicePosSelect}"
							selectionMode="single" resizableColumns="true" var="item">
						<f:facet name="{Exporters}">
							  <span class="pagecurrentdisplay">
							     <h:outputText value="(#{invoicePosBean.navigationInfo.currentPage} of #{invoicePosBean.navigationInfo.totalPage})" />
							  </span>
							  <ul class="pagination pagination-sm" style="margin: 0px 0px !important;">
							      <li><p:commandLink disabled="#{invoicePosBean.navigationInfo.currentPage ==1}" styleClass="fa fa-angle-double-left font_weightcus"  update="tablesp" actionListener="#{invoicePosBean.paginatorChange(1)}" /> </li>
							      <li><p:commandLink disabled="#{invoicePosBean.navigationInfo.currentPage ==1}" styleClass="fa fa-angle-left font_weightcus"  update="tablesp" actionListener="#{invoicePosBean.paginatorChange(invoicePosBean.navigationInfo.currentPage-1)}" /> </li>
								  <c:forEach var="index" items="#{invoicePosBean.navigationInfo.indexList}">
									  <li class="#{invoicePosBean.navigationInfo.currentPage==index ? 'active' : ''}"><p:commandLink   update="tablesp" value="#{index}" actionListener="#{invoicePosBean.paginatorChange(index)}" /> </li>
								  </c:forEach>
								  <li><p:commandLink disabled="#{invoicePosBean.navigationInfo.currentPage == invoicePosBean.navigationInfo.totalPage}" styleClass="fa fa-angle-right font_weightcus"  update="tablesp" actionListener="#{invoicePosBean.paginatorChange(invoicePosBean.navigationInfo.currentPage +1)}" /></li>
							      <li><p:commandLink disabled="#{invoicePosBean.navigationInfo.currentPage == invoicePosBean.navigationInfo.totalPage}" styleClass="fa fa-angle-double-right font_weightcus"  update="tablesp" actionListener="#{invoicePosBean.paginatorChange(invoicePosBean.navigationInfo.totalPage)}" /></li>
								</ul>
								<span class="rowperpage">
						        <p:selectOneMenu 
									value="#{invoicePosBean.pageSize}"
									converter="abstractConverter" effect="fade" var="t"
									style="width:50px;margin-left:10px !important;">
									<f:selectItems value="#{invoicePosBean.listRowPerPage}"
										var="theme" itemLabel="#{theme}"
										itemValue="#{theme}" />
									<p:column>
										<h:outputText value="#{t}" />
									</p:column>
									<p:ajax update="tablesp"  listener="#{invoicePosBean.paginatorChange(1)}"></p:ajax>
								</p:selectOneMenu>
						        </span>
					     </f:facet>
					     <p:ajax event="rowSelect" listener="#{invoicePosBean.showEditInvoice()}" update="menuformid:tabview1:tab2real,menuformid:tabview1:tongthue,menuformid:tabview1:tongtien" />
							<p:column headerText="Mã Hóa đơn" width="70">
								<h:outputText value="#{item.invoice_code}" />
							</p:column>
							<p:column headerText="Số chứng từ" width="100">
								<h:outputText value="#{item.voucher_code}" />
							</p:column>
							<p:column headerText="Ngày đơn hàng" width="100">
								 <h:outputText value="#{item.invoice_date}">
									<f:convertDateTime pattern="dd/MM/yyyy"/>
								  </h:outputText>
							</p:column>
							<p:column headerText="Khách hàng" width="250">
								<h:outputText style="white-space: initial;" value="#{item.customer.customer_name}" />
							</p:column>
							<p:column headerText="Người tạo" width="120">
							    <h:outputText value="#{item.created_by}" />
							</p:column>
							<p:column headerText="Trạng thái" width="120">
							     <h:outputText rendered="#{item.status==0}" style="color:red;" value="Phiếu tạm" />
							     <h:outputText rendered="#{item.status==1}"  style="color:#4bac4d;" value="Hoàn thành" />
							</p:column>
							<p:column headerText="Số xe" width="80" >
								<h:outputText value="#{item.car.license_plate}" />
							</p:column>
							<p:column headerText="P/O" width="80" >
								<h:outputText value="#{item.po_no}" />
							</p:column>
							<p:column headerText="Loại xuất nhập" width="120" >
								<h:outputText value="#{item.ie_categories.content}" />
							</p:column>
							<p:column headerText="CT.Đơn giá" width="80">
							    <h:outputText value="#{item.pricing_program.program_code}" />
							</p:column>
							<p:column headerText="CT.Khuyến mãi" width="80">
							    <h:outputText value="#{item.promotion_program.program_code}" />
							</p:column>
							<p:column headerText="Kho" width="120">
							    <h:outputText value="#{item.warehouse.name}" />
							</p:column>
							<p:column headerText="Thanh toán" width="70" styleClass="textcenter">
							    <p:selectBooleanCheckbox disabled="true" value="#{item.payment}"/>
							</p:column>
							<p:column headerText="Ghi chú" >
								<h:outputText value="#{item.note }" />
							</p:column>
					</p:dataTable>
	          </div>
	           </div>
		       </p:tab>
		      </p:tabView>
		 </h:form>
	</div>
	<p:dialog styleClass="dialogCus" resizable="false" width="800" style="overflow: initial;"
		closeOnEscape="true" header="Hợp đồng vận chuyển" widgetVar="dlg2">
		<p:ajax event="close" update="dlg2" listener="#{orderLixBean.closeDialogPickHDVC()}" />
		<h:form id="dlg2" style="width:100%;">
		   <div class="col-md-12 boxCus">
		      <div class="row">
		          <div class="col-md-4" style="padding-left:0px !important;">
		              <label>Từ ngày</label>
		          </div>
		          <div class="col-md-4">
		              <label>Đến ngày</label>
		          </div>
		          <div class="col-md-4">
		              <label>Số hợp đồng</label>
		          </div>
		      </div>
		      <div class="row">
		          <div class="col-md-4" style="padding-left:0px !important;">
		               <p:calendar value="#{orderLixBean.fromDateFCFilter}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true" />
		          </div>
		          <div class="col-md-4">
		              <p:calendar value="#{orderLixBean.toDateFCFilter}" pattern="dd/MM/yyyy" showOn="button" mask="99/99/9999" showButtonPanel="true" />
		          </div>
		          <div class="col-md-4" style="padding-right:0px !important;">
		             <p:inputText value="#{orderLixBean.contractNoFCFilter}"  style="width:100%;"/>
		          </div>
		      </div>
		       <div class="row">
		          <div class="col-md-4" style="padding-left:0px !important;">
		              <label>Loại khách hàng</label>
		          </div>
		          <div class="col-md-4">
		              <label>Khách hàng</label>
		          </div>
		      </div>
		       <div class="row">
		          <div class="col-md-4" style="padding-left: 0px !important;">
		              <p:selectOneMenu 
						value="#{orderLixBean.customerTypesFCFilter}"
						converter="abstractConverter" effect="fade" var="t"
						style="width:100%;">
						<f:selectItem itemLabel="Tất cả" itemValue="#{null}" />
						<f:selectItems value="#{orderLixBean.listCustomerTypes}"
							var="theme" itemLabel="#{theme.name}"
							itemValue="#{theme}" />
						<p:column>
							<h:outputText value="#{t.code}" />
						</p:column>
						<p:column>
							<h:outputText value="#{t==null ? 'Tất cả' : t.name}" />
						</p:column>
					</p:selectOneMenu>
		          </div>
		          <div class="col-md-4">
		              <p:autoComplete style="width:100%;"
							value="#{orderLixBean.customerFcFilter}" queryDelay="1000"
							maxResults="50"
							converter="abstractConverter" minQueryLength="2" 
							completeMethod="#{orderLixBean.completeCustomerFC}" var="p"
							itemLabel="#{p.customer_name}" itemValue="#{p}"
							forceSelection="true" onclick="this.select();">
							<p:column style="width:50px">
							   <h:outputText value="#{p.customer_code}" />
							</p:column>
							<p:column style="width:150px">
							    <h:outputText value="#{p.customer_name}" />
							 </p:column>
						</p:autoComplete>
		          </div>
		          <div class="col-md-4">
		               <p:commandButton icon="fa fa-search" 
					  style="padding:4px !important;" styleClass="buttonaddrow" value="Tìm kiếm"  />
		          </div>
		      </div>
		      <div class="row" style="margin-top: 5px;">
					<p:dataTable value="#{orderLixBean.listFreightContractSelect}" lazy="true"
							paginatorPosition="bottom" styleClass="tablenhapsp" style="width:100%;"
							paginator="true" rowKey="#{item.id}" id="tbselectfc"
							scrollable="true" scrollHeight="350"  paginatorTemplate="{Exporters}"
							selectionMode="single" resizableColumns="true" var="item">
						<f:facet name="{Exporters}">
							  <span class="pagecurrentdisplay">
							     <h:outputText value="(#{orderLixBean.navigationInfoHDVC.currentPage} of #{orderLixBean.navigationInfoHDVC.totalPage})" />
							  </span>
							  <ul class="pagination pagination-sm" style="margin: 0px 0px !important;">
							      <li><p:commandLink disabled="#{orderLixBean.navigationInfoHDVC.currentPage ==1}" styleClass="fa fa-angle-double-left font_weightcus"  update="tbselectfc" actionListener="#{orderLixBean.paginatorChangeHDVC(1)}" /> </li>
							      <li><p:commandLink disabled="#{orderLixBean.navigationInfoHDVC.currentPage ==1}" styleClass="fa fa-angle-left font_weightcus"  update="tbselectfc" actionListener="#{orderLixBean.paginatorChangeHDVC(orderLixBean.navigationInfoHDVC.currentPage-1)}" /> </li>
								  <c:forEach var="index" items="#{orderLixBean.navigationInfoHDVC.indexList}">
									  <li class="#{orderLixBean.navigationInfoHDVC.currentPage==index ? 'active' : ''}"><p:commandLink   update="tbselectfc" value="#{index}" actionListener="#{orderLixBean.paginatorChangeHDVC(index)}" /> </li>
								  </c:forEach>
								  <li><p:commandLink disabled="#{orderLixBean.navigationInfoHDVC.currentPage == orderLixBean.navigationInfoHDVC.totalPage}" styleClass="fa fa-angle-right font_weightcus"  update="tbselectfc" actionListener="#{orderLixBean.paginatorChangeHDVC(orderLixBean.navigationInfoHDVC.currentPage +1)}" /></li>
							      <li><p:commandLink disabled="#{orderLixBean.navigationInfoHDVC.currentPage == orderLixBean.navigationInfoHDVC.totalPage}" styleClass="fa fa-angle-double-right font_weightcus"  update="tbselectfc" actionListener="#{orderLixBean.paginatorChangeHDVC(orderLixBean.navigationInfoHDVC.totalPage)}" /></li>
								</ul>
								<span class="rowperpage">
						        <p:selectOneMenu 
									value="#{orderLixBean.pageSizeHDVC}"
									converter="abstractConverter" effect="fade" var="t"
									style="width:50px;margin-left:10px !important;">
									<f:selectItems value="#{orderLixBean.listRowPerPageHDVC}"
										var="theme" itemLabel="#{theme}"
										itemValue="#{theme}" />
									<p:column>
										<h:outputText value="#{t}" />
									</p:column>
									<p:ajax update="tbselectfc"  listener="#{orderLixBean.paginatorChangeHDVC(1)}"></p:ajax>
								</p:selectOneMenu>
						        </span>
					     </f:facet>
					     <p:ajax 
					        event="rowDblselect" 
					        listener="#{orderLixBean.rowFreightContractClick}" 
					        update="menuformid:tabview1:tab2real" />
						<p:column headerText="Mã hợp đồng" width="70">
							<h:outputText value="#{item.contract_code}" />
						</p:column>
						<p:column headerText="Số hợp đồng" width="70">
							<h:outputText value="#{item.contract_no}" />
						</p:column>
						<p:column headerText="Ngày" width="60">
							<h:outputText value="#{item.contract_date}">
							    <f:convertDateTime pattern="dd/MM/yyyy"/>
							</h:outputText>
						</p:column>
						<p:column headerText="Mã KH" width="50">
							<h:outputText value="#{item.customer.customer_code}" />
						</p:column>
						<p:column headerText="Khách hàng" width="250">
							<h:outputText value="#{item.customer.customer_name}" />
						</p:column>
						<p:column headerText="Thanh toán" width="60">
							<p:selectBooleanCheckbox disabled="true" value="#{item.payment}" />
						</p:column>
						<p:column headerText="Ngày thanh toán" width="70">
							<h:outputText value="#{item.payment_date}">
							    <f:convertDateTime pattern="dd/MM/yyyy"/>
							</h:outputText>
						</p:column>
						<p:column headerText="HTTT" width="70">
							<h:outputText value="#{item.payment_method.payment}"/>
						</p:column>
					</p:dataTable>
				</div>
		   </div>
		</h:form>
	</p:dialog>
	<p:dialog styleClass="dialogCus" resizable="false" width="450" style="overflow: initial;"
		closeOnEscape="true" header="Chi tiết hóa đơn" widgetVar="idlg1">
		<h:form id="idlg1" style="width:100%;">
		   <div class="col-md-12 boxCus">
		      <div class="col-md-12" style="padding-left:0px !important; padding-right:5px !important;">
		          <div class="col-md-12" style="padding-left:0px !important; padding-right:0px !important; margin-bottom: 5px;">
			         <div class="row">
			             <label>Sản phẩm</label>
			         </div>
			         <div class="row">
			             <p:autoComplete style="width:100%;"
							value="#{invoicePosBean.wrapInvoiceDetailPosCrud.invoice_detail_pos.product}"
							queryDelay="900" maxResults="200"
							converter="abstractConverter" minQueryLength="2" 
							completeMethod="#{invoicePosBean.completeProduct}" var="p"
							itemLabel="#{p.product_name}" itemValue="#{p}"
							forceSelection="true" onclick="this.select();">
							<p:column style="width:50px">
							   <h:outputText value="#{p.product_code}" />
							</p:column>
							<p:column style="width:150px">
							    <h:outputText value="#{p.product_name}" />
							 </p:column>
						</p:autoComplete>
			         </div>
			      </div>
			      <div class="col-md-12" style="padding-left:0px !important; padding-right:0px !important; margin-bottom: 5px;">
			         <div class="row">
			             <label>Số lượng</label>
			         </div>
			         <div class="row">
			              <p:inputNumber  value="#{invoicePosBean.wrapInvoiceDetailPosCrud.invoice_detail_pos.quantity}" styleClass="fix_width100"
								minValue="0" decimalPlaces="3" decimalSeparator="," thousandSeparator=".">
						   </p:inputNumber>
			         </div>
			      </div>
			      <div class="col-md-6" style="padding-left:0px !important; padding-right:5px !important; margin-bottom: 5px;">
			         <div class="row">
			             <label>Đơn giá</label>
			         </div>
			         <div class="row">
			             <p:inputText readonly="true" value="#{invoicePosBean.formatHandler.getNumberFormat(invoicePosBean.wrapInvoiceDetailPosCrud.invoice_detail_pos.unit_price,1000)}" />
			         </div>
			      </div>
			      <div class="col-md-6" style="padding-left:5px !important; padding-right:0px !important; margin-bottom: 5px;">
			         <div class="row">
			             <label>Thành tiền</label>
			         </div>
			         <div class="row">
			             <p:inputText readonly="true" value="#{invoicePosBean.formatHandler.getNumberFormat(invoicePosBean.wrapInvoiceDetailPosCrud.invoice_detail_pos.unit_price*invoicePosBean.wrapInvoiceDetailPosCrud.invoice_detail_pos.quantity,1000)}" />
			         </div>
			      </div>
			      <div class="col-md-12" style="padding-left:0px !important; padding-right:0px !important; margin-bottom: 5px;">
			         <div class="row">
			             <label>Mã sản phẩm DH</label>
			         </div>
			         <div class="row">
			             <p:inputText value="#{invoicePosBean.wrapInvoiceDetailPosCrud.invoice_detail_pos.productdh_code}" />
			         </div>
			      </div>
		      </div>
		   </div>
		   <div class="col-md-12" style="padding:10px 0px !important;">
		        <p:commandLink   process="" update="menuformid:tabview1:tablect,menuformid:tabview1:tongthue,menuformid:tabview1:tongtien"   action="#{invoicePosBean.saveOrUpdateInvoiceDetail()}" styleClass="btn_primmary" style=" " >
	                    <i class="fa fa-floppy-o" aria-hidden="true"></i><span>Lưu/cập nhật</span>
	              </p:commandLink>
			</div>
		</h:form>
	</p:dialog>
	<p:dialog styleClass="dialogcommon" resizable="false" width="700" style="overflow: initial;"
		closeOnEscape="true" header="Chọn lô hàng" widgetVar="dlgexport">
		<f:facet name="header">
            <h:form id="dlgheader">
              <h:outputText style="font-size:13px;" value="#{invoicePosBean.wrapInvoiceDetailPosPick.invoice_detail_pos.product.product_name}" />
            </h:form>
        </f:facet>
		<h:form id="dlgexport" style="width:100%;">
		      <div class="col-md-12" style="padding-left:0px !important; padding-right:0px !important; margin-top: 5px; margin-bottom: 10px;">
		          <div class="row">
		          
			           <div class="col-md-2" style="padding-left: 0px !important;padding-right:2px !important;">
			                <label>Số thùng/pallet</label>
			           </div>
			           <div class="col-md-5" style="padding-left: 3px !important;padding-right:3px !important;">
			                <label>Số lượng yêu cầu</label>
			           </div>
			           <div class="col-md-5" style="padding-left: 2px !important;padding-right:0px !important;">
			                <label>Số lượng thực xuất</label>
			           </div>
			           <div class="col-md-2" style="padding-left: 0px !important;padding-right:2px !important;">
			               <p:inputText readonly="true" style="color: red;font-weight: bold;font-size: 14px;" value="#{invoicePosBean.formatHandler.getNumberFormat(invoicePosBean.wrapInvoiceDetailPosPick.invoice_detail_pos.product.box_quantity,1000)}" />
			           </div>
			           <div class="col-md-5" style="padding-left: 3px !important;padding-right:3px !important;">
			               <p:inputText style="color: red;font-weight: bold;font-size: 14px;" readonly="true" value="#{invoicePosBean.formatHandler.getNumberFormat(invoicePosBean.wrapInvoiceDetailPosPick.invoice_detail_pos.quantity,1000)}" />
			           </div>
			           <div class="col-md-5" style="padding-left: 2px !important;padding-right:0px !important;">
			                <p:inputText style="color: red;font-weight: bold;font-size: 14px;" readonly="true"  value="#{invoicePosBean.formatHandler.getNumberFormat(invoicePosBean.wrapInvoiceDetailPosPick.invoice_detail_pos.real_quantity,1000)}" />
			           </div>
		          </div>
		      </div>
		      <div class="col-md-12" style="padding-left:0px !important; padding-right:0px !important;">
		          <p:dataTable id="xuatLH" style="width:100%; min-height:100px; height:auto;" styleClass="tablenhapsp tableright0" scrollable="true" 
		          scrollHeight="200" var="itemex" value="#{invoicePosBean.listWrapExportDataPosCrud}" paginatorPosition="bottom" rowsPerPageTemplate="90,180,250" >
			        <p:column headerText="" width="10" styleClass="textcenter">
			           <p:selectBooleanCheckbox value="#{itemex.select}">
			              <p:ajax event="change" listener="#{invoicePosBean.selectExportBatchPos(itemex)}" update="dlgexport,messages" />
			           </p:selectBooleanCheckbox>
			        </p:column>
			        <p:column headerText="Lô hàng" width="20"  styleClass="textcenter" >
			           <h:outputText  value="#{itemex.export_batch_pos.product_pos.batch_pos.batch_code}" />
			        </p:column>
			        <p:column headerText="Vị trí" width="118" styleClass="textcenter">
			           <h:outputText style="font-size:11px;" value="#{itemex.export_batch_pos.product_pos.pos.warehouse.name}" />
			             <i class="fa fa-caret-right icright" aria-hidden="true"></i>
			           <h:outputText style="font-size:11px;" value="#{itemex.export_batch_pos.product_pos.pos.barcode}" />
			        </p:column>
			        <p:column headerText="số thùng tồn" width="33"  styleClass="textright">
			           <h:outputText  value="#{invoiceBean.formatHandler.getNumberFormat(itemex.export_batch_pos.product_pos.quantity_import-itemex.export_batch_pos.product_pos.quantity_export,1000)}" />
			        </p:column>
			        <p:column headerText="số thùng xuất" width="40">
			            <p:inputNumber   onclick="this.select()" value="#{itemex.quantity_export_box}" styleClass="inputtext_nhapsp" style="width:100%;"
							minValue="0" decimalPlaces="0" decimalSeparator="," maxValue="10000000" thousandSeparator=".">
                          <p:ajax event="keyup" delay="800" listener="#{invoicePosBean.changeQuantityExportBatch(itemex)}" update="dlgexport,messages" />
                        </p:inputNumber>
			        </p:column>
			    </p:dataTable>
		      </div>
		      <div class="col-md-12" style="padding-left:0px !important;padding-right:0px !important;">
		           <p:commandLink  update="messages"   action="#{invoicePosBean.saveOrUpdateExportBatchPos()}" styleClass="btn_primmary" style=" " >
	                    <i class="fa fa-floppy-o" aria-hidden="true"></i><span>Lưu/Cập nhật</span>
	              </p:commandLink>
		      </div>
		</h:form>
	</p:dialog>
	</ui:define>
</ui:composition>